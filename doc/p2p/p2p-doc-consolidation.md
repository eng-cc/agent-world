# P2P 文档集中治理与过期归档（设计文档）

## 目标
- 将仓库内分散的 P2P / 区块链 / 共识 / 分布式文件系统（DistFS）文档集中到 `doc/p2p`，降低检索和维护成本。
- 对明确已被后续阶段替代或历史分卷的文档进行归档，统一放置到 `doc/p2p/archive`。
- 为归档文档增加“已过期”标识，避免误用旧方案。

## 范围

### In Scope
- 扫描 `doc/` 下与以下主题强相关文档：
  - `p2p`
  - `blockchain`（区块链）
  - `consensus`（共识）
  - `distfs`（分布式文件系统）
  - `libp2p` / `dht` / `gossip`
- 将上述文档从原路径迁移到 `doc/p2p`。
- 识别并归档过期文档到 `doc/p2p/archive`。
- 更新仓库内对迁移文档的引用路径。

### Out of Scope
- 修改文档中描述的技术方案本身。
- 重写历史内容，仅补充必要的过期标识。
- 调整 `third_party/` 下任何文件。

## 接口 / 数据
- 新目录：`doc/p2p/`
- 归档目录：`doc/p2p/archive/`
- 过期标识模板（加在归档文档开头）：
  - `> [!WARNING]`
  - `> 该文档已过期，仅供历史追溯，不再作为当前实现依据。`
  - `> 归档日期：2026-02-16`
- 迁移清单文件：`doc/p2p/archive/migration-map.md`

## 里程碑
- M1：建立治理文档（设计 + 项目管理）并冻结判定口径。
- M2：完成文档迁移到 `doc/p2p`。
- M3：完成过期文档归档并补充过期标识。
- M4：完成路径引用修复与基础校验。
- M5：完成二轮“文档-代码”对照核查，追加归档技术口径过期文档。

## 二轮核查结论（2026-02-16）
- 通过文档路径引用存在性检查，发现一批文档仍依赖已删除路径：
  - `crates/agent_world/src/runtime/distributed*`
  - `crates/agent_world/src/runtime/distributed_membership_sync*`
- 上述能力已迁移到 split crate（`agent_world_consensus` / `agent_world_net` / `agent_world_distfs`），原文档技术落点已过期。
- 已将该批文档归档到 `doc/p2p/archive`，并统一补充“已过期”标识。

## 风险
- 批量迁移后可能存在遗漏引用，导致文档链接断裂。
- “过期”判定可能存在主观性，需要采用“明确历史分卷/明确被后续阶段替代”作为保守标准。
- 文档数量较多，需通过迁移映射清单保证可追踪性。
- 二轮归档后，部分活跃文档依赖关系会指向 archive，需要在后续新设计文档中逐步补齐“当前基线文档”。
