# 2026-02-25

- 时刻：2026-02-25 10:38:34 CST
- 完成内容：完成“Viewer WebGL Deferred 兼容降级”T0（设计建档）。
  - 新增设计文档：`doc/world-simulator/viewer-webgl-deferred-compat-2026-02-24.md`
  - 新增项目管理文档：`doc/world-simulator/viewer-webgl-deferred-compat-2026-02-24.project.md`
  - 项目状态：T0 完成，T1 进行中。
- 测试：
  - 文档任务（无代码测试）。
- 遗留事项：
  - 执行 T1：实现 wasm 路径关闭默认 deferred lighting 插件。

- 时刻：2026-02-25 10:43:37 CST
- 完成内容：完成“Viewer WebGL Deferred 兼容降级”T1（wasm 渲染兼容改造）。
  - `crates/agent_world_viewer/src/app_bootstrap.rs`：
    - 新增 `default_pbr_plugin_for_runtime()`，在 wasm 目标下将 `PbrPlugin.add_default_deferred_lighting_plugin` 设为 `false`。
    - `run_ui` 的 `DefaultPlugins` 配置接入该函数。
    - 新增单测 `default_pbr_plugin_for_runtime_tracks_target_compat_mode`。
  - 项目状态：T0/T1 完成，T2 进行中。
- 测试：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer default_pbr_plugin_for_runtime_tracks_target_compat_mode -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_viewer`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_viewer --target wasm32-unknown-unknown`
- 遗留事项：
  - 执行 T2：Playwright 3D 闭环复验，确认不再出现 `copy_deferred_lighting_id_pipeline` panic。

- 时刻：2026-02-25 10:52:53 CST
- 完成内容：完成“Viewer WebGL Deferred 兼容降级”T2（定向回归验证）。
  - 新增回归总结：`output/playwright/viewer/webgl-3d-panic-fix-20260225-104748/summary.md`
  - Playwright 3D 用例结果：
    - `cameraMode` 从 `2d` 切至 `3d`，并在 step/play 后持续推进。
    - `apiAlive: true`，稳定等待后仍可访问测试 API。
    - 未复现 `copy_deferred_lighting_id_pipeline` panic。
  - 项目状态：T0/T1/T2 完成，T3 进行中。
- 测试：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer default_pbr_plugin_for_runtime_tracks_target_compat_mode -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_viewer`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_viewer --target wasm32-unknown-unknown`
  - Playwright 3D 回归产物：`output/playwright/viewer/webgl-3d-panic-fix-20260225-104748/check3d.txt`
- 遗留事项：
  - 执行 T3：回写最终状态并收口。
