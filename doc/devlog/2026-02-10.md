- 日期：2026-02-10
- 完成内容：新增《GitHub Pages 对外展示站点设计》（`doc/github-pages-showcase.md`），明确目标、范围、方案对比、接口/数据、里程碑、风险与首版验收标准。
- 完成内容：新增项目管理文档（`doc/github-pages-showcase.project.md`），完成首版任务拆解、依赖和状态定义。
- 完成内容：完成仓库现状调研（`README.md`、`.github/workflows/rust.yml`、现有文档模板），确认当前尚无 GitHub Pages 相关实现。
- 完成内容：完成 GitHub Pages 首版落地：新增 `site/index.html`、`site/assets/styles.css`、`site/assets/app.js`、`site/assets/images/world-loop.svg`，形成可独立部署的静态对外展示页。
- 完成内容：新增 Pages 自动部署工作流 `.github/workflows/pages.yml`，采用 `actions/configure-pages/upload-pages-artifact/deploy-pages` 标准链路，触发路径限定为 `site/**` 等相关文件。
- 完成内容：更新 `README.md` 文档入口，新增对外展示站点地址 `https://eng-cc.github.io/agent-world/`。
- 完成内容：执行 `env -u RUSTC_WRAPPER cargo check`（通过）。
- 完成内容：完成双语增强：新增英文页 `site/en/index.html`，中文页 `site/index.html` 与英文页互相提供语言切换入口（CN/EN）。
- 完成内容：新增站点 favicon `site/assets/images/favicon.svg`，消除本地预览 `favicon.ico` 404 控制台报错。
- 完成内容：按 Playwright 闭环完成本地双页校验并截图（中文页、英文页）：`output/playwright/pages-bilingual/.playwright-cli/page-2026-02-10T04-04-40-518Z.png`、`output/playwright/pages-bilingual/.playwright-cli/page-2026-02-10T04-04-58-834Z.png`。
- 完成内容：执行 `env -u RUSTC_WRAPPER cargo check`（通过，双语增强后再次校验）。
- 完成内容：新增首访语言自动跳转逻辑（英文浏览器首访根路径自动跳转 `/en/`），实现于 `site/assets/app.js`。
- 完成内容：新增手动语言选择记忆（点击 CN/EN 后写入本地存储并停止后续自动跳转），保证用户偏好优先。
- 完成内容：按 Playwright 闭环验证自动跳转策略：
  - `locale=en-US` 首访 `http://127.0.0.1:4176/` 自动到 `/en/`；
  - 同会话手动切回中文后再次访问根路径保持中文，不再自动跳转；
  - `locale=zh-CN` 首访保持中文页。
- 完成内容：自动跳转验证截图：`output/playwright/pages-lang-redirect/.playwright-cli/page-2026-02-10T04-15-30-720Z.png`、`output/playwright/pages-lang-redirect/.playwright-cli/page-2026-02-10T04-15-32-306Z.png`。
- 完成内容：按反馈将语言标识弱化并固定到右上角（`中/EN`），降低视觉权重且保留可用性；同步优化移动端位置与菜单相对关系。
- 完成内容：右上角样式验证截图：`output/playwright/pages-lang-topright/.playwright-cli/page-2026-02-10T04-25-01-673Z.png`。
- 完成内容：按反馈将语言入口改为“最右侧地球图标按钮”，点击展开语言下拉菜单（中文/English），并保持原有手动语言选择记忆逻辑。
- 完成内容：新增图标资源 `site/assets/images/globe.svg`，并补充点击外部关闭/ESC 关闭下拉交互。
- 完成内容：地球图标方案验证截图：`output/playwright/pages-globe/.playwright-cli/page-2026-02-10T04-32-04-262Z.png`（闭合态）、`output/playwright/pages-globe/.playwright-cli/page-2026-02-10T04-32-38-666Z.png`（展开态）。
- 完成内容：根据“精细化打磨 GitHub Pages（科技感 + 内容充实）”目标，新增二期设计文档 `doc/github-pages-wow-polish.md`，明确体验蓝图、视觉与交互策略、里程碑和验收标准。
- 完成内容：新增二期项目管理文档 `doc/github-pages-wow-polish.project.md`，按执行优先级拆分任务（内容重构、视觉系统、交互增强、素材证据、SEO、质量门禁）。
- 完成内容：启动二期首轮落地，实现中英文首页信息架构重写：Why / Matrix / Architecture / Scenarios / Demo / Roadmap / Quality / FAQ / Contribute 全链路模块。
- 完成内容：完成科技感视觉系统升级（`site/assets/styles.css`）：设计 Token、背景光效、卡片与按钮层次、代码块优化、移动端响应式重构。
- 完成内容：完成轻量交互增强（`site/assets/app.js`）：section reveal、导航激活态、指标计数动画（含 reduced-motion 降级与兜底显示）。
- 完成内容：完成 SEO 元信息增强：双语页补充 OpenGraph/Twitter Card/canonical/hreflang。
- 完成内容：按“边做边看”要求完成 Playwright 截图回归并统一放入 `.tmp/screens/`（避免污染 git），关键截图包括：
  - `.tmp/screens/pages-after-v3-zh-full.png`
  - `.tmp/screens/pages-after-v3-en-full.png`
  - `.tmp/screens/pages-after-v3-zh-mobile-viewport.png`
  - `.tmp/screens/pages-after-v3-en-mobile-viewport.png`
  - `.tmp/screens/pages-after-v3-zh-900.png`
  - `.tmp/screens/pages-after-v3-en-900.png`
- 完成内容：完成时间线交互增强：新增筛选条（All/Done/In Progress/Next；中文对应全部/已完成/进行中/下一阶段），支持按状态聚焦里程碑节点。
- 完成内容：完成语言菜单键盘无障碍：补充 `aria-haspopup/aria-controls` 与键盘行为（Enter/Space/ArrowUp/ArrowDown/Escape）焦点流转。
- 完成内容：补充时间线筛选条粘性展示样式（sticky toolbar），便于长页面滚动时快速切换里程碑视图。
- 完成内容：按第二轮改造完成截图回归（`.tmp/`）：
  - `.tmp/screens/pages-after-v4-zh-900.png`
  - `.tmp/screens/pages-after-v4-en-900.png`
  - `.tmp/screens/pages-after-v4-zh-mobile.png`
  - `.tmp/screens/pages-after-v4-en-mobile.png`
  - `.tmp/screens/pages-after-v4b-zh-roadmap-900.png`
  - `.tmp/screens/pages-after-v4b-en-roadmap-900.png`
- 完成内容：完成 Lighthouse 门禁检测（本地 `http://127.0.0.1:4180`）：
  - 中文页：Performance 100 / Accessibility 100 / Best Practices 100 / SEO 100；
  - 英文页：Performance 100 / Accessibility 100 / Best Practices 100 / SEO 100；
  - 结果文件：`.tmp/lighthouse/zh-report`、`.tmp/lighthouse/en-report`。
- 完成内容：完成关键锚点与外链 smoke check：
  - 中英文页锚点校验无断链；
  - 外链（GitHub 相关）状态码均为 200，记录于 `.tmp/lighthouse/link-smoke.log`。
- 完成内容：完成资源体积预算检查并通过，记录于 `.tmp/lighthouse/resource-budget.txt`：
  - `styles.css` 15461B（<= 20480B）
  - `app.js` 11060B（<= 15360B）
  - `world-loop.svg` 3868B（<= 10240B）
  - 关键静态资产总量 31594B（<= 51200B）。
- 完成内容：新增发布前检查清单 `doc/github-pages-wow-polish.release-checklist.md`，覆盖视觉、交互、SEO、质量门禁与上线人工确认项。
- 完成内容：人工确认环节完成：GitHub Pages Settings（Source=GitHub Actions）与线上地址双语切换/首访行为均已通过人工验收。
- 完成内容：按脚本闭环产出首批真实 viewer 截图素材（4 张），并落地到 `site/assets/images/screenshots/`：
  - `minimal.webp`
  - `twin_region_bootstrap.webp`
  - `triad_region_bootstrap.webp`
  - `asteroid_fragment_bootstrap.webp`
- 完成内容：新增分享封面图 `site/assets/images/og-cover.png`（1200×630），并替换中英文页 `og:image` 指向该封面图。
- 完成内容：在中英文“实战场景”模块新增真实 viewer 截图画廊与对应 caption，补强对外展示证据链。
- 完成内容：新增素材后的页面回归截图（`.tmp/`）：
  - `.tmp/screens/pages-after-v5-zh-full.png`
  - `.tmp/screens/pages-after-v5-en-full.png`
  - `.tmp/screens/pages-after-v5-zh-scenarios-900.png`
- 完成内容：完成素材压缩与资源优化：
  - 4 张场景截图从 PNG 转为 WebP，单图约 66~67KB；
  - `og-cover.png` 优化至约 32KB；
  - 新增素材后 Lighthouse 复测仍为中英文 100/100/100/100（`.tmp/lighthouse/zh-report-v6`、`.tmp/lighthouse/en-report-v6`）。
- 完成内容：新增架构示意图 `site/assets/images/architecture-flow.svg`（Runtime/Simulator/Viewer/LLM + Persistence/Feedback 流），并接入中英文架构模块展示。
- 完成内容：架构示意图接入后回归截图：
  - `.tmp/screens/pages-after-v7b-zh-architecture-900.png`
  - `.tmp/screens/pages-after-v7b-en-architecture-900.png`
- 完成内容：架构示意图接入后 Lighthouse 复测仍为中英文 100/100/100/100（`.tmp/lighthouse/zh-report-v7`、`.tmp/lighthouse/en-report-v7`）。
- 完成内容：新增三期对标优化设计文档与项目管理文档：
  - `doc/github-pages-benchmark-polish-v3.md`
  - `doc/github-pages-benchmark-polish-v3.project.md`
- 完成内容：完成中英文首页结构优化（`site/index.html`、`site/en/index.html`）：
  - Hero 改为体验优先叙事（30 秒快速体验 / 设计文档 / 源码）
  - 新增 `#path` 三段式理解路径模块（30 秒 / 3 分钟 / 30 分钟）
  - 新增 `#proof` 真实运行证据模块（命令闭环 / 事件样例 / 近期更新）
  - 新增导航锚点 `path`、`proof` 并保持中英文同构顺序。
- 完成内容：新增 Hero 世界观主视觉素材 `site/assets/images/world-constellation.svg` 并接入双语页面。
- 完成内容：完成视觉层级收敛与重点强化（`site/assets/styles.css`）：
  - 收敛通用卡片边框/发光强度，降低“全高亮”噪声；
  - 新增 `hero-lead`、`hero-proof-points`、`story-path`、`proof-grid` 等样式体系；
  - 新增 `button.ghost` 并强化主 CTA 视觉优先级。
- 完成内容：完成叙事路径步骤高亮交互（`site/assets/app.js`），支持滚动激活与 `prefers-reduced-motion` 降级。
- 完成内容：更新 README 展示站说明，补充三期亮点摘要（体验优先 CTA、三段式路径、证据模块）。
- 完成内容：完成 Playwright 截图回归（本地 `http://127.0.0.1:4191`），关键截图：
  - `.tmp/screens/zh-full-v3-polish.png`
  - `.tmp/screens/en-full-v3-polish.png`
  - `.tmp/screens/zh-mobile-v3-polish.png`
  - `.tmp/screens/en-mobile-v3-polish.png`
  - `.tmp/screens/zh-path-proof-900-v3-polish.png`
  - `.tmp/screens/en-path-proof-900-v3-polish.png`
- 完成内容：执行锚点 smoke check（中英文 `href="#..."` 全部命中，无缺失）。
- 完成内容：执行 `env -u RUSTC_WRAPPER cargo check`（通过）。
- 完成内容：继续按“逐步落地”推进 Proof 增量交互（中英文同步）：
  - 在 `#proof` 模块新增“场景事件时间线切换器”（minimal / twin_region / triad_region / asteroid_fragment）；
  - 事件样例 code block 改为按场景切换显示；
  - 新增场景事件时间线列表并随切换同步更新。
- 完成内容：新增 Proof 切换交互样式（`site/assets/styles.css`）：
  - `proof-switcher` / `proof-switch-btn` 按钮组；
  - `proof-timeline` / `proof-timeline-item` 证据时间线卡片；
  - 通过 `data-proof-visible` 控制面板与事件可见性。
- 完成内容：新增 Proof 切换交互逻辑（`site/assets/app.js`）：
  - 新增 `bindProofSwitcher()`，支持点击切换与 ArrowLeft/ArrowRight 键盘切换；
  - 切换时同步更新按钮 active 态、code panel 与事件时间线可见态。
- 完成内容：完成 Proof 切换回归截图（本地 `http://127.0.0.1:4195`）：
  - 中文：`.tmp/screens/zh-proof-minimal-v3b.png`、`.tmp/screens/zh-proof-twin-v3b.png`、`.tmp/screens/zh-proof-triad-v3b.png`、`.tmp/screens/zh-proof-asteroid-v3b.png`
  - 英文：`.tmp/screens/en-proof-minimal-v3b.png`、`.tmp/screens/en-proof-twin-v3b.png`、`.tmp/screens/en-proof-triad-v3b.png`、`.tmp/screens/en-proof-asteroid-v3b.png`
  - 自动校验结果：每次切换仅对应场景的 code/event 可见（控制台日志已验证）。
- 完成内容：执行 `env -u RUSTC_WRAPPER cargo check`（Proof 交互增强后再次通过）。
- 遗留事项：`site/assets/styles.css` 体积为 19861B，接近 20KB 门槛；后续新增样式建议继续拆分或压缩整理。
- 遗留事项：GitHub Pages 首次发布需在仓库 Settings 中确认 Source 为 GitHub Actions；部署后可继续补充真实 viewer 截图/GIF 与双语 FAQ。
- 完成内容：完成 3D 可视化现状与瓶颈梳理，形成“精致化 + 性能优化”专项规划基线（覆盖视觉层次、标签密度、覆盖层与网格线开销、缺少性能预算等问题）。
- 完成内容：新增《Viewer 3D 精致化与性能优化设计》（`doc/world-simulator/viewer-3d-polish-performance.md`），补齐目标、范围、接口/数据、里程碑、验收口径与风险。
- 完成内容：新增项目管理文档（`doc/world-simulator/viewer-3d-polish-performance.project.md`），完成任务拆解、依赖、状态与里程碑检查点定义。
- 完成内容：执行文档类变更自检（结构与命名规范符合当前仓库文档约定，单文档行数未超限制）。
- 遗留事项：按 `VPP3` 先落地性能基线采样（triad/llm 场景），建立可量化对比数据后再推进渲染分档与性能优化实现。
- 完成内容：执行 3D viewer 截图闭环（`llm_bootstrap`，地址 `127.0.0.1:5023`），产出基线截图 `/.tmp/screens/baseline/window-before-lighting.png`。
- 完成内容：定位并绕过本机并发 `cargo run` 造成的包锁阻塞（闭环脚本本次改用已编译二进制链路验证）；确认 `target/debug` 直跑会因 `assets/` 相对路径导致字体缺失，统一改回仓库根目录 `cargo run` 链路抓取有效画面。
- 完成内容：完成首轮渲染优化并通过测试：
  - `viewer_3d_config` 新增 lighting 配置（阴影开关、环境光亮度、补光比例），默认 `shadows=false` 以优先性能；
  - `main.rs` 接入 `GlobalAmbientLight` 与补光方向光；
  - `material_library.rs` 为 Location 材质增加按 `MaterialKind` 的轻量色彩分层，提升对象区分度。
- 完成内容：完成第二轮闭环截图验证，优化后截图 `/.tmp/screens/after4/window-after-color-pass-cwdfix.png`，与基线哈希不同，确认改动实际生效（基线 `b2388...` -> 优化后 `da1a57...`）。
- 完成内容：更新项目管理文档 `viewer-3d-polish-performance.project.md`，将 VPP3/VPP4/VPP10 标记为已完成，并同步阶段状态。
- 完成内容：执行验证：`env -u RUSTC_WRAPPER cargo fmt`、`env -u RUSTC_WRAPPER cargo test -p agent_world_viewer material_library -- --nocapture`、`env -u RUSTC_WRAPPER cargo test -p agent_world_viewer viewer_3d_config -- --nocapture`、`env -u RUSTC_WRAPPER cargo check`（均通过）。
- 遗留事项：继续推进 VPP5~VPP9（选中高亮强化、标签 LOD、覆盖层批处理/节流、性能摘要面板），并补充 triad 场景同口径闭环对比图。
- 完成内容：完成 Agent 渲染方式改造第一阶段：主体由球体替换为胶囊体（Capsule），保持 `height_cm` 到机体高度比例映射，避免“点状 Agent”难以区分。
- 完成内容：完成模块数量可视表达接入：
  - `Viewer3dScene` 新增 `agent_module_counts` 缓存，并在 Agent 选择摘要中展示 `modules={count}`；
  - Snapshot 重建时优先从 `module_visual_entities` 统计 Agent 模块数量；
  - 无可视模块实体时使用 `AgentBodyState::default().slots` 已安装数兜底；
  - Agent 上附加“模块节点环 + 模块数量立柱（上限16）”，强化数量感知。
- 完成内容：完成遮挡与可见性修正：
  - 新增 `agent_location_ids` 与 `location_radii_cm` 场景缓存，Agent 在 Location 表面上方并带横向偏移渲染，降低与 Location 球体重叠遮挡；
  - Agent 改为父节点容器 + 子节点主体/模块，移除父级非均匀缩放对子节点的连带影响；
  - 为 Agent 父节点补齐 `Visibility`，消除层级可见性告警。
- 完成内容：补充并通过测试：
  - `spawn_agent_entity_uses_body_height_scale`
  - `spawn_agent_entity_renders_module_markers_up_to_cap`
  - `rebuild_scene_maps_agent_module_count_from_module_visual_entities`
  - `rebuild_scene_uses_default_module_count_when_no_module_visual_entities`
- 完成内容：执行编译与测试校验（通过）：
  - `env -u RUSTC_WRAPPER cargo fmt`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_viewer`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer spawn_agent_entity_uses_body_height_scale -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer spawn_agent_entity_renders_module_markers_up_to_cap -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer module_count -- --nocapture`
- 完成内容：执行截图闭环（手工串行链路）并产出对比图：
  - `/.tmp/manual-window-llm.png`
  - `/.tmp/manual-window-triad.png`
- 遗留事项：在默认 `2D` 俯视尺度下，模块节点已可见但仍偏细小；下一步建议补“默认 3D 视角闭环 + 模块类型分色/图例 + 可选模块夸张系数开关”，在不破坏物理口径的前提下进一步提升第一眼可读性。
- 完成内容：完成 Agent 模块渲染第二阶段“立方体拼接机器人”改造：
  - `scene_helpers.rs` 将模块布局升级为机器人槽位优先（头/肩/躯干/臂位）+ 超量环层补位；
  - 布局主轴改为在 `X/Z` 平面展开，适配默认 `2D` 俯视可读性；
  - 模块立方体尺寸与间距参数整体上调，并将模块材质改为高对比青色，降低与 Agent 主体/Location 的混色。
- 完成内容：补充并通过布局相关测试与回归校验：
  - `env -u RUSTC_WRAPPER cargo fmt`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_viewer`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer spawn_agent_entity_uses_body_height_scale -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer spawn_agent_entity_renders_module_markers_up_to_cap -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer spawn_agent_entity_robot_layout_places_head_slot_first -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer module_count -- --nocapture`
- 完成内容：完成闭环截图复核并确认改动生效：
  - `/.tmp/manual-window-llm-cubes-v2.png`
  - `/.tmp/manual-window-triad-cubes-v2.png`
- 遗留事项：当前 2D 俯视下“模块拼接体”已可读，但“机器人轮廓”在远尺度仍偏紧凑；如需更强第一眼辨识，可继续追加“2D 模式模块可视化倍率”开关或默认 3D 视角预设。
- 完成内容：按“Agent 应只在 Location 表面”要求，修正 `agent_translation_for_render`：
  - 由“固定 Y 抬升 + 侧向偏移”改为“沿 Location 中心到 Agent 的径向法线贴附”；
  - 贴附半径采用 `location_radius + body_half_height + surface_gap`（仅保留极小防穿插间隙）。
- 完成内容：新增并通过表面贴附单测 `spawn_agent_entity_attaches_to_location_surface`，验证 Agent 机体中心到 Location 中心距离与理论半径差在小范围内。
- 完成内容：闭环截图复核（表面贴附版）：
  - `/.tmp/manual-window-llm-cubes-v3-surface.png`
- 遗留事项：可按展示需要补充动态演示 GIF 或分场景专题页。
- 完成内容：新增《LLM 请求层迁移至 async-openai Responses API 设计文档》（`doc/world-simulator/llm-async-openai-responses.md`）和对应项目管理文档（`doc/world-simulator/llm-async-openai-responses.project.md`），明确目标、范围、接口/数据、里程碑、风险和任务拆解。
- 完成内容：将 `crates/agent_world/src/simulator/llm_agent.rs` 的 OpenAI 兼容请求层从手写 `chat/completions`（blocking reqwest）迁移到 `async-openai` Responses API（同步封装调用），保留 `LlmCompletionClient` 对外接口不变。
- 完成内容：新增 base URL 归一化能力 `normalize_openai_api_base_url`，兼容 `.../v1`、`.../v1/chat/completions`、`.../v1/responses` 配置输入。
- 完成内容：完成工具注册与调用适配：使用 Responses `Tool::Function` 注册 `agent_modules_list` / `environment_current_observation` / `memory_short_term_recent` / `memory_long_term_search`，并将 `OutputItem::FunctionCall` 统一映射为内部 `{"type":"module_call",...}` 协议。
- 完成内容：保留短超时自动回退重试策略（当配置超时低于默认值时，首轮超时后自动以默认超时重试一次）。
- 完成内容：更新并替换 LLM 客户端相关测试（`crates/agent_world/src/simulator/llm_agent/tests.rs`）：新增 Responses payload 构造校验、工具注册校验、`function_call -> module_call` 映射校验、无效 JSON 参数 `_raw` 回退校验、base URL 归一化校验。
- 完成内容：更新文档说明：`README.md`、`config.example.toml`、`doc/world-simulator/llm-agent-behavior.md`、`doc/world-simulator/llm-prompt-multi-step-orchestration.md`、`doc/world-simulator/llm-prompt-multi-step-orchestration.project.md`。
- 完成内容：执行验证命令并通过：
  - `env -u RUSTC_WRAPPER cargo fmt --all -- --check`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world normalize_openai_api_base_url_handles_suffix_variants -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world responses_tools_register_expected_function_names -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world response_function_call_maps_to_module_call_json -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world response_function_call_invalid_json_arguments_are_preserved_as_raw -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world build_responses_request_payload_includes_tools_and_auto_choice -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world openai_client_enables_timeout_retry_when_timeout_below_default -- --nocapture`
- 完成内容：补充 OpenAI 兼容响应“宽松解析兜底”能力：当 `async-openai` 在 Responses 反序列化阶段因缺失字段（如 `output_text.annotations`）失败时，回退到原始 JSON 解析并提取 `output.function_call` / `message.output_text`，避免整轮降级 `Wait`。
- 完成内容：新增兼容单测：
  - `completion_result_from_raw_response_json_parses_function_call_without_annotations`
  - `completion_result_from_raw_response_json_parses_output_text_without_annotations`
- 完成内容：执行真实多轮验证：
  - `env -u RUSTC_WRAPPER cargo run -p agent_world --bin world_llm_agent_demo -- llm_bootstrap --ticks 2 --report-json .tmp/llm_multi_round_compat/report.json`
  - `env -u RUSTC_WRAPPER cargo run -p agent_world --bin world_llm_agent_demo -- llm_bootstrap --ticks 3 --report-json .tmp/llm_multi_round_compat_3/report.json`
  - 结果：`llm_errors=0`，连续多轮成功执行 `HarvestRadiation` 动作。
- 遗留事项：GitHub Pages 首次发布需在仓库 Settings 中确认 Source 为 GitHub Actions；部署后可继续补充真实 viewer 截图/GIF 与双语 FAQ。
- 遗留事项：LLM 迁移后的真实线上端到端验证（带真实模型与密钥的 `world_llm_agent_demo` 长跑）待按环境配置执行。
- 日期：2026-02-10
- 完成内容：执行 `env -u RUSTC_WRAPPER cargo run -p agent_world --bin world_llm_agent_demo -- llm_bootstrap --ticks 30 --report-json .tmp/llm_multi_round_30/report.json` 并确认 30 tick 长跑结果可用（`active_ticks=30`、`llm_errors=0`、`action_success=26`）。
- 完成内容：核查并清理残留 `world_llm_agent_demo` 后台进程，避免后续端口/资源干扰本地验证。
- 遗留事项：30 tick 报告中仍有 `parse_errors=4`，后续可继续细化 Responses 输出兼容解析与提示词约束以降低解析噪声。
- 日期：2026-02-10
- 完成内容：将 30 tick 实跑观察到的遗留问题补充到 LLM 相关文档，新增“后续优化点”条目：
  - `doc/world-simulator/llm-async-openai-responses.md`
  - `doc/world-simulator/llm-prompt-multi-step-orchestration.md`
  - `doc/world-simulator/llm-async-openai-responses.project.md`
  - `doc/world-simulator/llm-prompt-multi-step-orchestration.project.md`
- 完成内容：将 `parse_errors=4`、`harvest_radiation` 极端参数、`wait` 空转比例、Prompt 上下文膨胀等问题固化为可跟踪任务（AOR11~AOR13、LMSO23~LMSO26）。
- 遗留事项：按新增任务分批实现并复测 30 tick 指标收敛情况。
- 日期：2026-02-10
- 完成内容：新增《场景种子化地点生成》设计文档与项目管理文档：
  - `doc/world-simulator/scenario-seed-locations.md`
  - `doc/world-simulator/scenario-seed-locations.project.md`
- 完成内容：实现场景地点生成新策略：`WorldScenarioSpec` 移除显式 `locations`，新增 `location_generator`，由 `seed` 确定性生成地点（`crates/agent_world/src/simulator/scenario.rs`）。
- 完成内容：实现 Agent 出生策略改造：移除 `AgentSpawnConfig.location_id/spawn_locations`，改为从可用地点集合中按 `seed` 派生随机出生（`crates/agent_world/src/simulator/init.rs`）。
- 完成内容：批量更新内置场景 JSON 到新 schema（新增 `seed`，多地点场景改为 `location_generator`）：
  - `crates/agent_world/scenarios/*.json`
- 完成内容：同步更新并通过相关测试与调用方断言：
  - `crates/agent_world/src/simulator/tests/init.rs`
  - `crates/agent_world/src/viewer/demo.rs`
  - `crates/agent_world/src/viewer/live.rs`
- 完成内容：同步更新文档口径（场景文件与初始化分册）：
  - `doc/world-simulator/scenario-files.md`
  - `doc/world-simulator/world-initialization.md`
- 完成内容：执行验证命令并通过：
  - `env -u RUSTC_WRAPPER cargo fmt --all`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --no-run`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world simulator::tests::init -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world viewer::demo::tests::plan_demo_actions_includes_move_for_multi_location_scenario -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world viewer::live::tests::live_script_moves_between_locations -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --test world_init_demo -- --nocapture`
- 完成内容：将 `WorldScenarioSpec` 解析切为严格模式（`deny_unknown_fields`），旧字段（如 `locations`、`agents.location_id`、`spawn_locations`）将直接报错，避免隐式兼容路径。
- 完成内容：严格模式后再次执行并通过：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world simulator::tests::init -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo fmt --all`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world`
- 遗留事项：当前地点生成仅覆盖 `count/id_prefix/name_prefix` 与默认 profile/resources；后续如需场景化资源差异与布局约束，可在 `location_generator` 增加分布和资源模板参数。

- 日期：2026-02-10
- 完成内容：完成 LMSO23 输入侧收敛优化（优先改 prompt 而非解析器）：
  - `crates/agent_world/src/simulator/llm_agent/prompt_assembly.rs`
  - `crates/agent_world/src/simulator/llm_agent/decision_flow.rs`
  - `crates/agent_world/src/simulator/llm_agent/behavior_loop.rs`
- 完成内容：新增输入约束与收敛门槛：单 JSON 输出、模块白名单、`module_calls_remaining/turns_remaining` 动态提示、预算临界强制终态 decision。
- 完成内容：补充单测并通过：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world prompt_assembly_includes_single_json_constraints -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world prompt_assembly_step_meta_contains_remaining_budget_hints -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world llm_agent_supports_plan_module_draft_finalize_flow -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world llm_agent_prompt_contains_execute_until_and_exploration_guidance -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world`
- 完成内容：实跑验证：
  - `env -u RUSTC_WRAPPER cargo run -p agent_world --bin world_llm_agent_demo -- llm_bootstrap --ticks 2 --report-json .tmp/lmso23_prompt_2_smoke/report.json --print-llm-io --llm-io-max-chars 2000`
  - `env -u RUSTC_WRAPPER cargo run -p agent_world --bin world_llm_agent_demo -- llm_bootstrap --ticks 4 --report-json .tmp/lmso23_prompt_4/report.json`
  - 结果：两次均 `parse_errors=0`、`llm_errors=0`。
- 遗留事项：30 tick 全量回归受在线请求时延波动影响，需在稳定窗口补跑同口径长跑对比（基线 `.tmp/llm_multi_round_30/report.json`）。
- 日期：2026-02-10
- 完成内容：补跑 LMSO23 的 30 tick 全量回归：`env -u RUSTC_WRAPPER cargo run -p agent_world --bin world_llm_agent_demo -- llm_bootstrap --ticks 30 --report-json .tmp/lmso23_prompt_30_final/report.json`。
- 完成内容：完成同口径对比（基线 `.tmp/llm_multi_round_30/report.json` -> 当前 `.tmp/lmso23_prompt_30_final/report.json`）：`parse_errors 4 -> 0`、`repair_rounds_total 3 -> 0`、`decision.wait 4 -> 0`、`prompt_section_clipped 8 -> 0`。
- 完成内容：更新 LMSO23 设计/项目文档的验证结论与阶段状态：
  - `doc/world-simulator/llm-prompt-multi-step-orchestration.md`
  - `doc/world-simulator/llm-prompt-multi-step-orchestration.project.md`
- 遗留事项：进入 LMSO24，优先补充 `harvest_radiation.max_amount` 参数护栏并复测 30 tick 指标。
- 日期：2026-02-10
- 完成内容：完成 LMSO24 动作参数护栏：
  - 新增配置 `AGENT_WORLD_LLM_HARVEST_MAX_AMOUNT_CAP`（默认 `100`，正整数校验）。
  - 在 Prompt `Decision JSON Schema` 与运行时 `[Output Constraints]` 中加入 `harvest_radiation.max_amount` 上限约束。
  - 对 `decision` / `decision_draft` / `execute_until.action` 三条路径统一裁剪超限 `max_amount`，并记录 `max_amount clamped` trace 摘要。
- 完成内容：代码变更文件：
  - `crates/agent_world/src/simulator/llm_agent/config_helpers.rs`
  - `crates/agent_world/src/simulator/llm_agent.rs`
  - `crates/agent_world/src/simulator/llm_agent/behavior_loop.rs`
  - `crates/agent_world/src/simulator/llm_agent/prompt_assembly.rs`
  - `crates/agent_world/src/simulator/llm_agent/tests.rs`
  - `README.md`
  - `config.example.toml`
- 完成内容：关键验证命令通过：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world llm_config_rejects_invalid_harvest_max_amount_cap -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world llm_agent_clamps_harvest_max_amount_to_configured_cap -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world llm_agent_clamps_execute_until_harvest_action_to_configured_cap -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world prompt_assembly_includes_harvest_max_amount_cap -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world`
- 完成内容：30 tick 回归：
  - `env -u RUSTC_WRAPPER cargo run -p agent_world --bin world_llm_agent_demo -- llm_bootstrap --ticks 30 --report-json .tmp/lmso24_guard_30/report.json`
  - 结果：`parse_errors=0`、`llm_errors=0`、`repair_rounds_total=0`、`action_success=30`、`action_failure=0`。
  - 对比 LMSO23（`.tmp/lmso23_prompt_30_final/report.json`）：`action_success 29 -> 30`，`llm_input_chars_max 14056 -> 10094`。
- 完成内容：更新 LMSO24 设计/项目管理文档阶段状态：
  - `doc/world-simulator/llm-prompt-multi-step-orchestration.md`
  - `doc/world-simulator/llm-prompt-multi-step-orchestration.project.md`
- 遗留事项：进入 LMSO25，继续优化 `execute_until` 模板与重入策略，目标在保持护栏生效前提下进一步提升动作效率。
- 日期：2026-02-10
- 完成内容：完成 LMSO25 决策效率优化（`execute_until` 模板 + 重入策略）：
  - Prompt `Decision JSON Schema` 增加 move/harvest 推荐 `execute_until` 模板。
  - 新增配置 `AGENT_WORLD_LLM_EXECUTE_UNTIL_AUTO_REENTER_TICKS`（默认 `4`，`0` 关闭）。
  - 运行时新增连续同动作自动重入：当模型连续输出同一动作且未显式给出 `execute_until` 时，自动挂载短周期 `execute_until`。
  - 新增 step trace：`execute_until_auto_reentry`。
- 完成内容：代码变更文件：
  - `crates/agent_world/src/simulator/llm_agent/execution_controls.rs`
  - `crates/agent_world/src/simulator/llm_agent/behavior_loop.rs`
  - `crates/agent_world/src/simulator/llm_agent/prompt_assembly.rs`
  - `crates/agent_world/src/simulator/llm_agent.rs`
  - `crates/agent_world/src/simulator/llm_agent/tests.rs`
  - `README.md`
  - `config.example.toml`
- 完成内容：关键验证命令通过：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world llm_config_rejects_invalid_execute_until_auto_reenter_ticks -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world llm_agent_auto_reentry_arms_execute_until_for_repeated_actions -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world llm_agent_auto_reentry_can_be_disabled -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world llm_agent_execute_until_continues_without_llm_until_event -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world prompt_assembly_includes_harvest_max_amount_cap -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world`
- 完成内容：30 tick 回归：
  - `env -u RUSTC_WRAPPER cargo run -p agent_world --bin world_llm_agent_demo -- llm_bootstrap --ticks 30 --report-json .tmp/lmso25_efficiency_30/report.json`
  - 结果：`parse_errors=0`、`llm_errors=0`、`repair_rounds_total=0`、`action_success=30`、`action_failure=0`。
  - 对比 LMSO24（`.tmp/lmso24_guard_30/report.json`）：`module_call 8 -> 6`、`plan 2 -> 1`、`llm_input_chars_total 43829 -> 35333`、`llm_input_chars_avg 1460 -> 1177`。
  - 观察：本次样本 `llm_input_chars_max` 上升到 `16967`，并出现 `prompt_section_clipped=1`，后续由 LMSO26 继续收敛。
- 完成内容：更新 LMSO25 设计/项目管理文档阶段状态：
  - `doc/world-simulator/llm-prompt-multi-step-orchestration.md`
  - `doc/world-simulator/llm-prompt-multi-step-orchestration.project.md`
- 遗留事项：进入 LMSO26，优先处理 prompt 峰值输入（`llm_input_chars_max`）与裁剪触发（`prompt_section_clipped`）。
- 日期：2026-02-10
- 完成内容：新增《Viewer Location 细粒度渲染设计文档》与对应项目管理文档（`doc/world-simulator/viewer-location-fine-grained-rendering.md`、`doc/world-simulator/viewer-location-fine-grained-rendering.project.md`），明确目标、范围、接口数据、里程碑与风险。
- 完成内容：实现 Location 细粒度渲染：`location` 从单球体扩展为“主球体 + 细节子节点（ring/halo）”，并按 `radius_cm` 与 `radiation_emission_per_tick` 分档生成细节层。
- 完成内容：Location 渲染链路改造为携带辐射字段（快照重建 + 增量事件均接入 `profile.radiation_emission_per_tick`），并在选择链路中同步消费该字段。
- 完成内容：新增 viewer 单元测试覆盖细粒度渲染行为：无辐射时仅 ring、有辐射时 halo 生效；同时更新原有 location 半径断言测试。
- 完成内容：新增场景 `crates/agent_world/scenarios/asteroid_fragment_detail_bootstrap.json`（开启 asteroid_fragment、关闭 origin/agent、多 bootstrap chunks）用于细粒度渲染观察。
- 完成内容：场景体系接入新场景枚举/解析/别名/稳定矩阵，并补充测试：`asteroid_fragment_detail_bootstrap_seeds_dense_fragments_for_viewer`、`world_init_demo_runs_asteroid_fragment_detail_summary`。
- 完成内容：同步更新截图脚本场景白名单与别名（支持 `asteroid_fragment_detail_bootstrap` / `asteroid_fragment_detail`），并更新场景文档覆盖矩阵。
- 完成内容：执行测试与校验：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer spawn_location_entity_uses_physical_radius_scale -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer spawn_location_entity_renders_fine_grained_ring_details -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer spawn_location_entity_renders_radiation_halo_details -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world asteroid_fragment_detail_bootstrap -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world world_init_demo_runs_asteroid_fragment_detail_summary -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world scenario_aliases_parse -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world scenarios_are_stable -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo check`
- 完成内容：执行截图闭环 `./scripts/capture-viewer-frame.sh --scenario asteroid_fragment_detail_bootstrap --addr 127.0.0.1:5130 --tick-ms 300 --viewer-wait 12`，产出截图 `.tmp/screens/window.png`，确认细粒度 location 点位已在场景中可见。
- 遗留事项：若需更明显观察 ring/halo 细节，建议后续在 3D 视角放大并补充“location 细节显隐开关”与截图基线断言。
- 日期：2026-02-10
- 完成内容：新增《Viewer 自动聚焦（人机共用 + 截图闭环）设计文档》与项目管理文档：
  - `doc/world-simulator/viewer-auto-focus-capture.md`
  - `doc/world-simulator/viewer-auto-focus-capture.project.md`
- 完成内容：在 viewer 中实现自动聚焦能力（启动自动聚焦 + 人工快捷键聚焦）：
  - 新增 `crates/agent_world_viewer/src/auto_focus.rs`，支持目标解析（`first_fragment/first_location/first_agent/location:<id>/agent:<id>`）与半径估算。
  - 启动路径接入环境变量：`AGENT_WORLD_VIEWER_AUTO_FOCUS`、`AGENT_WORLD_VIEWER_AUTO_FOCUS_TARGET`、`AGENT_WORLD_VIEWER_AUTO_FOCUS_FORCE_3D`、`AGENT_WORLD_VIEWER_AUTO_FOCUS_RADIUS`。
  - 新增 `F` 键聚焦当前选中实体，便于人工巡检细节。
- 完成内容：修复自动聚焦系统与相机查询冲突（Bevy B0001）：
  - 将 `auto_focus` 中实体变换查询限制为 `Without<Viewer3dCamera>`，避免与相机查询发生同组件写读冲突。
  - 在 `sync_camera_mode` 中新增一次性跳过标志，避免自动聚焦切换 3D 后被同步逻辑立刻覆写。
- 完成内容：截图闭环脚本新增自动聚焦参数：
  - `scripts/capture-viewer-frame.sh` 新增 `--auto-focus-target`、`--auto-focus-radius`、`--auto-focus-keep-2d`。
  - macOS/Linux 分支均支持按参数注入 `AGENT_WORLD_VIEWER_AUTO_FOCUS_*` 环境变量。
- 完成内容：测试与验证通过：
  - `env -u RUSTC_WRAPPER cargo check`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_viewer`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer parse_auto_focus_target_variants -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer config_from_values_enables_when_target_is_valid -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer resolve_target_prefers_first_fragment_then_location -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer spawn_location_entity_renders_fine_grained_ring_details -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer spawn_location_entity_renders_radiation_halo_details -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world asteroid_fragment_detail_bootstrap -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --test world_init_demo world_init_demo_runs_asteroid_fragment_detail_summary -- --nocapture`
  - `./scripts/capture-viewer-frame.sh --scenario asteroid_fragment_detail_bootstrap --addr 127.0.0.1:5131 --tick-ms 300 --viewer-wait 12 --auto-focus-target first_fragment --auto-focus-radius 18`
- 完成内容：截图闭环验证已产出 `.tmp/screens/window.png`，自动聚焦后可在密集碎片场景中稳定截取目标区域。
- 遗留事项：如需更高一致性，可后续补充“自动聚焦结果文本日志（目标 ID/半径）”供 CI 截图基线比对。
- 日期：2026-02-10
- 完成内容：按要求新增独立 Viewer 说明书文件（不改主 README）：
  - `doc/world-simulator/viewer-manual.md`
- 完成内容：说明书覆盖 Viewer 快速启动、常用交互、自动聚焦环境变量、`F` 快捷键、截图闭环命令与常见问题排查。
- 完成内容：在说明书中补充 `asteroid_fragment_detail_bootstrap` 场景的自动聚焦截图示例，便于细粒度渲染观察与复现。
- 遗留事项：后续如增加新的 Viewer 热键或面板模块，需要同步更新 `viewer-manual.md`。
- 日期：2026-02-10
- 完成内容：按反馈将 Viewer 说明书从子目录上移至文档最外层：
  - `doc/world-simulator/viewer-manual.md` -> `doc/viewer-manual.md`
- 完成内容：保持说明书内容不变，仅调整路径，便于快速检索。
- 遗留事项：若后续文档目录重组，需同步更新引用链接。
