- 日期：2026-02-14
- 完成内容：新增《Viewer 工业风可视化缺口收敛》设计文档与项目管理文档，按缺口分组固化四个任务组（A=1+2，B=3，C=5+6，D=7）：
  - `doc/world-simulator/viewer-industrial-visual-closure.md`
  - `doc/world-simulator/viewer-industrial-visual-closure.project.md`
- 完成内容：回写总项目文档 `doc/world-simulator.project.md`，挂载工业风可视化分册入口，并新增 A/B/C/D 任务项。
- 遗留事项：继续执行 IVA（任务 A：产线可视化 + 物流网络可视化）并补齐测试、日志与提交。

- 日期：2026-02-14
- 完成内容：完成 IVA（任务 A：产线可视化 + 物流网络可视化）首版落地。
  - 新增工业摘要模块：`crates/agent_world_viewer/src/ui_text_industrial.rs`。
  - 产线摘要：聚合 `module_visual_entities` 与近期 `CompoundRefined/ModuleVisualEntityUpserted`，输出工厂/配方/制成品/物流可视实体与近期产出指标。
  - 物流路由：聚合近期 `ResourceTransferred/PowerTransferred`，输出活跃路由、传输事件、路由吞吐与损耗。
  - 右侧详情面板按需新增 `Industrial Ops` 区块（仅有工业信号时显示），避免影响现有默认信息流：
    - `crates/agent_world_viewer/src/egui_right_panel.rs`
    - `crates/agent_world_viewer/src/ui_text.rs`
  - 新增工业区块中英文本地化映射与单测：`crates/agent_world_viewer/src/ui_locale_text.rs`。
- 完成内容：更新项目文档状态：
  - `doc/world-simulator/viewer-industrial-visual-closure.project.md`（IVA.1~IVA.4 标记完成）
  - `doc/world-simulator.project.md`（工业风缺口收敛任务 A 标记完成）
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer ui_text_industrial -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer localize_industrial_ops_block_supports_zh -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_viewer`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer`
- 遗留事项：继续推进 IVB（任务 B：经营面板）并定义供需/成本/收益/库存健康口径。

- 日期：2026-02-14
- 完成内容：完成 IVB（任务 B：经营面板）首版落地。
  - 新增经营看板聚合模块：`crates/agent_world_viewer/src/ui_text_economy.rs`。
  - 供需指标：按 `ResourceTransferred/PowerTransferred/ActionRejected(InsufficientResource)` 聚合流量与缺口；按 snapshot 资源库存计算健康状态（stable/warn/critical）。
  - 成本与收益代理指标：`power trade settlement`、`refine electricity cost`、`power loss`、`outbound value proxy`、`margin proxy`。
  - 右侧详情区按需新增 `Economy Dashboard` 区块（仅存在经济信号时显示）：
    - `crates/agent_world_viewer/src/egui_right_panel.rs`
    - `crates/agent_world_viewer/src/ui_text.rs`
  - 新增经营看板本地化映射：`crates/agent_world_viewer/src/ui_locale_text.rs`。
- 完成内容：更新项目文档状态：
  - `doc/world-simulator/viewer-industrial-visual-closure.project.md`（IVB.1~IVB.3 标记完成）
  - `doc/world-simulator.project.md`（工业风缺口收敛任务 B 标记完成）
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer ui_text_economy -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer localize_economy_dashboard_block_supports_zh -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_viewer`
- 遗留事项：继续推进 IVC（任务 C：多尺度导航 + 告警根因）。

- 日期：2026-02-14
- 完成内容：完成 IVC（任务 C：多尺度导航 + 告警根因）首版落地。
  - 新增运营导航聚合模块：`crates/agent_world_viewer/src/ui_text_ops_navigation.rs`。
  - 多尺度摘要：
    - 世界层：近期活动/告警事件计数。
    - 区域层：按 chunk 聚合热点（events/alerts）。
    - 节点层：按 agent/location 聚合热点分数。
  - 告警根因：聚合 `ActionRejected` 的根因类型 Top 列表。
  - 右侧详情区新增可开关导航区块（默认关闭，启用环境变量 `AGENT_WORLD_VIEWER_SHOW_OPS_NAV=1`）：
    - `crates/agent_world_viewer/src/egui_right_panel.rs`
    - `crates/agent_world_viewer/src/ui_text.rs`
  - 新增导航区块本地化映射：`crates/agent_world_viewer/src/ui_locale_text.rs`。
- 完成内容：更新项目文档状态：
  - `doc/world-simulator/viewer-industrial-visual-closure.project.md`（IVC.1~IVC.3 标记完成）
  - `doc/world-simulator.project.md`（工业风缺口收敛任务 C 标记完成）
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer ui_text_ops_navigation -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer localize_ops_navigation_block_supports_zh -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer`
- 遗留事项：继续推进 IVD（任务 D：产品化表现层）。

- 日期：2026-02-14
- 完成内容：完成 IVD（任务 D：产品化表现层）收口。
  - 右侧详情区新增产品化表现层开关：`AGENT_WORLD_VIEWER_PRODUCT_STYLE`（默认关闭，不影响既有快照与交互）。
  - 产品化卡片抽离为独立模块 `crates/agent_world_viewer/src/egui_observe_section_card.rs`，并在 `egui_right_panel.rs` 接入，确保单文件不超过 1200 行。
  - 语义色板：按世界/活动/工业/经营/运营/详情/事件分配色调与强调色。
  - 动效开关：新增 `AGENT_WORLD_VIEWER_PRODUCT_STYLE_MOTION`，对工业/经营/运营/事件卡片提供轻量边框脉冲过渡。
  - 补充单测：环境开关解析与区块语义色调映射（`egui_right_panel_tests.rs`）。
- 完成内容：更新项目文档状态：
  - `doc/world-simulator/viewer-industrial-visual-closure.project.md`（IVD.1~IVD.3 标记完成）
  - `doc/world-simulator.project.md`（工业风缺口收敛任务 D 标记完成）
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_viewer`
  - `AGENT_WORLD_VIEWER_PRODUCT_STYLE=1 AGENT_WORLD_VIEWER_PRODUCT_STYLE_MOTION=1 ./scripts/capture-viewer-frame.sh --scenario llm_bootstrap --addr 127.0.0.1:5023 --tick-ms 300 --viewer-wait 12 --capture-max-wait 90 --no-prewarm`
- 遗留事项：Viewer 工业风可视化缺口收敛 A~D 已完成，后续按新需求进入下一批可玩化任务。

- 日期：2026-02-14
- 完成内容：新增“Viewer 2D 可视化精修”文档与任务挂载，响应“2D 可视化还太简陋”问题。
  - 设计文档：`doc/world-simulator/viewer-2d-visual-polish.md`
  - 项目管理文档：`doc/world-simulator/viewer-2d-visual-polish.project.md`
  - 总项目文档挂载：`doc/world-simulator.project.md`
- 遗留事项：继续推进 V2D1（2D 地图符号层）并完成测试与提交。

- 日期：2026-02-14
- 完成内容：完成 V2D1（2D 地图符号层）落地。
  - Location 增加 2D 地图符号（平面底板 + 中心点）：`map2d:location:*`。
  - Agent 增加 2D 地图符号（底板 + 模块带 + 中心点）：`map2d:agent:*`。
  - 新增模式联动系统 `sync_two_d_map_marker_visibility`，实现 TwoD 显示 / ThreeD 隐藏。
  - 代码位置：
    - `crates/agent_world_viewer/src/scene_helpers.rs`
    - `crates/agent_world_viewer/src/scene_helpers_entities.rs`
    - `crates/agent_world_viewer/src/camera_controls.rs`
    - `crates/agent_world_viewer/src/app_bootstrap.rs`
- 完成内容：更新项目文档状态：
  - `doc/world-simulator/viewer-2d-visual-polish.project.md`（V2D1.1~V2D1.3 标记完成）
  - `doc/world-simulator.project.md`（2D 精修任务 1 标记完成）
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer two_d_map_marker_visibility_follows_camera_mode -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer spawn_location_entity_renders_fine_grained_ring_details -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_viewer spawn_agent_entity_renders_module_markers_up_to_cap -- --nocapture`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_viewer`
- 遗留事项：继续推进 V2D2（标签可读性增强 + 截图闭环）。
