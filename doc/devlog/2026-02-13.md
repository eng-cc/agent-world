- 日期：2026-02-13
- 完成内容：推进 distributed crate split 二十二次扩展阶段，进一步消除 runtime 与新 crate 的重复实现：
  - `agent_world::runtime` 5 个模块改为直接复用新 crate 同源实现（`include!`）：
    - `crates/agent_world/src/runtime/distributed_net.rs`
    - `crates/agent_world/src/runtime/distributed_dht.rs`
    - `crates/agent_world/src/runtime/distributed_gateway.rs`
    - `crates/agent_world/src/runtime/distributed_lease.rs`
    - `crates/agent_world/src/runtime/distributed_mempool.rs`
  - 为支持跨 crate 同源复用，调整共享实现文件引用路径与导出可见性：
    - `crates/agent_world_net/src/network.rs`
    - `crates/agent_world_net/src/dht.rs`
    - `crates/agent_world_net/src/gateway.rs`
    - `crates/agent_world_net/src/lib.rs`
    - `crates/agent_world_consensus/src/lease.rs`
    - `crates/agent_world_consensus/src/mempool.rs`
  - `agent_world` 增加 `extern crate self as agent_world;`，使同源文件可统一通过 `agent_world::runtime::*` 路径解析：`crates/agent_world/src/lib.rs`
  - 回写设计/项目管理文档：
    - `doc/world-runtime/distributed-crate-split-net-consensus.md`
    - `doc/world-runtime/distributed-crate-split-net-consensus.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo check -p agent_world`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_net`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_consensus`
  - `env -u RUSTC_WRAPPER cargo test --workspace`
- 遗留事项：继续下一阶段，把 `distributed_client/index/provider_cache/dht_cache` 等 runtime 模块继续收敛到同源复用，并评估彻底切到 crate 级直接依赖所需的循环依赖解除方案。

- 日期：2026-02-13
- 完成内容：推进 distributed crate split 二十三次扩展阶段，继续消除 runtime 与 `agent_world_net` 的重复实现：
  - `agent_world::runtime` 5 个模块改为直接复用 `agent_world_net` 同源实现（`include!`）：
    - `crates/agent_world/src/runtime/distributed_client.rs`
    - `crates/agent_world/src/runtime/distributed_index.rs`
    - `crates/agent_world/src/runtime/distributed_index_store.rs`
    - `crates/agent_world/src/runtime/distributed_provider_cache.rs`
    - `crates/agent_world/src/runtime/distributed_dht_cache.rs`
  - 为支持跨 crate 同源复用，调整 `agent_world_net` 对应模块引用路径到 `super::distributed_*` / `super::error` / `super::modules`，并补齐兼容 alias 导出：
    - `crates/agent_world_net/src/client.rs`
    - `crates/agent_world_net/src/index.rs`
    - `crates/agent_world_net/src/index_store.rs`
    - `crates/agent_world_net/src/provider_cache.rs`
    - `crates/agent_world_net/src/dht_cache.rs`
    - `crates/agent_world_net/src/lib.rs`
    - `crates/agent_world_net/src/util.rs`
  - 回写设计/项目管理文档：
    - `doc/world-runtime/distributed-crate-split-net-consensus.md`
    - `doc/world-runtime/distributed-crate-split-net-consensus.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo check -p agent_world`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_net`
  - `env -u RUSTC_WRAPPER cargo test --workspace`
- 遗留事项：继续下一阶段，把 `distributed_bootstrap/head_follow/observer/observer_replay/storage/validation` 模块收敛到同源复用，并逐步推进解除 `agent_world` 与新 crate 的循环依赖。

- 日期：2026-02-13
- 完成内容：推进 distributed crate split 二十四次扩展阶段，继续消除 runtime 与 `agent_world_net` 的重复实现：
  - `agent_world::runtime` 6 个模块改为直接复用 `agent_world_net` 同源实现（`include!`）：
    - `crates/agent_world/src/runtime/distributed_bootstrap.rs`
    - `crates/agent_world/src/runtime/distributed_head_follow.rs`
    - `crates/agent_world/src/runtime/distributed_observer.rs`
    - `crates/agent_world/src/runtime/distributed_observer_replay.rs`
    - `crates/agent_world/src/runtime/distributed_storage.rs`（保留 `ExecutionWriteConfig/ExecutionWriteResult` 类型定义）
    - `crates/agent_world/src/runtime/distributed_validation.rs`（保留 `HeadValidationResult` 类型定义）
  - 为支持跨 crate 同源复用，调整 `agent_world_net` 对应模块引用路径到 `super::distributed_*` / `super::blob_store` / `super::world` / `super::events` / `super::segmenter` / `super::snapshot` / `super::types` / `super::world_event`，并补齐兼容 alias 导出：
    - `crates/agent_world_net/src/bootstrap.rs`
    - `crates/agent_world_net/src/head_follow.rs`
    - `crates/agent_world_net/src/observer.rs`
    - `crates/agent_world_net/src/observer_replay.rs`
    - `crates/agent_world_net/src/execution_storage.rs`
    - `crates/agent_world_net/src/head_validation.rs`
    - `crates/agent_world_net/src/lib.rs`
  - 回写设计/项目管理文档：
    - `doc/world-runtime/distributed-crate-split-net-consensus.md`
    - `doc/world-runtime/distributed-crate-split-net-consensus.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo check -p agent_world`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_net`
  - `env -u RUSTC_WRAPPER cargo test --workspace`
- 遗留事项：继续下一阶段，把 `distributed_consensus` / `distributed_membership_sync` 等 runtime 模块收敛到同源复用，并逐步推进解除 `agent_world` 与新 crate 的循环依赖。

- 日期：2026-02-13
- 完成内容：推进 distributed crate split 二十五次扩展阶段，继续消除 runtime 与 `agent_world_consensus` 的重复实现：
  - `agent_world::runtime` 的 `distributed_consensus` 改为直接复用 `agent_world_consensus` 同源实现（`include!`）：
    - `crates/agent_world/src/runtime/distributed_consensus.rs`
  - 为支持跨 crate 同源复用，调整 `agent_world_consensus` 对应模块引用路径到 `super::distributed_*` / `super::error` / `super::util`，并补齐兼容 alias 导出：
    - `crates/agent_world_consensus/src/quorum.rs`
    - `crates/agent_world_consensus/src/lib.rs`
  - 回写设计/项目管理文档：
    - `doc/world-runtime/distributed-crate-split-net-consensus.md`
    - `doc/world-runtime/distributed-crate-split-net-consensus.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo check -p agent_world`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_consensus`
  - `env -u RUSTC_WRAPPER cargo test --workspace`
- 遗留事项：继续下一阶段，把 `distributed_membership_sync` runtime 模块收敛到 `agent_world_consensus` 同源复用，并逐步推进解除 `agent_world` 与新 crate 的循环依赖。
- 完成内容：完成 BMS-35（runtime cutover 阶段一期收口）并执行回归验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_builtin_wasm`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::tests::agent_default_modules::`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::tests::power_bootstrap::`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::agent_default_modules::`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::power_bootstrap::`
- 完成内容：更新项目管理文档状态并标记 BMS-35 完成：
  - `doc/world-runtime/builtin-wasm-crate-split.project.md`
  - `doc/world-runtime.project.md`
- 遗留事项：进入 cutover 阶段二，按模块域逐步删除 runtime builtin fallback，优先收敛 `rule/body` 相关 builtin 路径。

- 日期：2026-02-13
- 完成内容：完成 BMS-36（cutover 阶段二设计扩展与任务拆解）：
  - 设计文档扩展阶段三目标与里程碑：`doc/world-runtime/builtin-wasm-crate-split.md`
  - 项目管理文档新增 BMS-36~BMS-39 任务并更新阶段状态：
    - `doc/world-runtime/builtin-wasm-crate-split.project.md`
    - `doc/world-runtime.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::tests::power_bootstrap::install_power_bootstrap_modules_registers_and_activates`
- 遗留事项：执行 BMS-37，从 `rule/body` 开始下线 builtin 测试注册并切到 wasm 工件优先执行。

- 日期：2026-02-13
- 完成内容：完成 BMS-37（`rule/body` 相关 builtin 测试注册下线，wasm 工件优先）：
  - `crates/agent_world/src/runtime/tests/rules.rs`：
    - `m1.rule.move/visibility/transfer` 安装夹具改为注册 `m1_builtin_modules.wasm` 工件。
    - 对应 `m1_*` 规则测试改为直接使用 `WasmExecutor`，去除 `register_builtin`。
    - wasm 路径测试加 `#[cfg(feature = "wasmtime")]` 门控。
  - `crates/agent_world/src/runtime/tests/body.rs`：
    - `m1.body.core` 安装夹具改为注册 `m1_builtin_modules.wasm` 工件。
    - body 动作相关测试改为 `WasmExecutor` 执行并移除 builtin 注册。
    - wasm 路径测试加 `#[cfg(feature = "wasmtime")]` 门控。
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::tests::rules::`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::tests::body::`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::rules::`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::body::`
- 遗留事项：继续执行 BMS-38，迁移 `sensor/mobility/memory/storage/power` 相关测试的 builtin fallback。

- 日期：2026-02-13
- 完成内容：完成 BMS-38（`sensor/mobility/memory/storage/power` 相关 builtin fallback 下线）：
  - `crates/agent_world/src/runtime/tests/agent_default_modules.rs`：
    - 模块级 `#[cfg(feature = "wasmtime")]` 门控，移除 builtin fallback 注册。
    - 默认/场景 sandbox 改为直接 `WasmExecutor`。
  - `crates/agent_world/src/runtime/tests/power_bootstrap.rs`：
    - 模块级 `#[cfg(feature = "wasmtime")]` 门控，移除 builtin fallback 注册。
    - power sandbox 改为直接 `WasmExecutor`。
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::tests::agent_default_modules::`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::tests::power_bootstrap::`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::agent_default_modules::`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::power_bootstrap::`
- 遗留事项：执行 BMS-39，清理 runtime 中不再使用的 builtin 模块实现导出与冗余回退路径。

- 日期：2026-02-13
- 完成内容：完成 BMS-39（runtime builtin 导出/回退路径收口）：
  - `crates/agent_world/src/runtime/mod.rs`：
    - 移除不再使用的 builtin 具体实现类型导出（仅保留 sandbox 抽象与模块常量导出）。
  - `crates/agent_world/src/runtime/builtin_modules.rs`：
    - `BuiltinModuleSandbox` 去除冗余 `new/with_fallback` 构造与 `prefer_fallback` 分支，统一为 wasm-first fallback 语义。
    - 增加模块级 `#![allow(dead_code, unused_imports)]`，用于 cutover 期间保留 native 实现代码但不作为默认执行路径。
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::builtin_modules::tests::`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::rules::`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::power_bootstrap::`
- 遗留事项：BMS cutover 阶段二已收口；是否进入阶段三（物理删除 native builtin 实现代码）待下一步指令。

- 日期：2026-02-13
- 完成内容：完成 BMS-40（cutover 阶段三启动与任务拆解）：
  - `doc/world-runtime/builtin-wasm-crate-split.md`：
    - 增补阶段三执行路线（BMS-40~BMS-43）与里程碑 M17。
    - 更新 runtime 装载工厂接口描述为 `with_preferred_fallback`。
  - `doc/world-runtime/builtin-wasm-crate-split.project.md`：
    - 新增 BMS-40~BMS-43 任务并将状态切换为阶段三进行中。
  - `doc/world-runtime.project.md`：
    - 同步新增 BMS-40~BMS-43 与全局状态更新。
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::builtin_modules::tests::`
- 遗留事项：执行 BMS-41，物理删除 `runtime/builtin_modules/*` native 实现文件并回归验证。

- 日期：2026-02-13
- 完成内容：完成 BMS-41（物理删除 runtime native builtin 老代码第一批）：
  - `crates/agent_world/src/runtime/builtin_modules.rs`：
    - 收敛为“模块常量 + `BuiltinModule` trait + `BuiltinModuleSandbox` 最小兼容层”。
    - 内联保留 `m1.power.*` 模块 ID、版本和参数常量，删除旧实现辅助函数与数据结构。
  - 删除 legacy native 实现源码：
    - `crates/agent_world/src/runtime/builtin_modules/body_module.rs`
    - `crates/agent_world/src/runtime/builtin_modules/default_modules.rs`
    - `crates/agent_world/src/runtime/builtin_modules/rule_modules.rs`
    - `crates/agent_world/src/runtime/builtin_modules/power_modules.rs`
    - `crates/agent_world/src/runtime/builtin_modules/power_modules/power_radiation_module.rs`
    - `crates/agent_world/src/runtime/builtin_modules/power_modules/power_storage_module.rs`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::builtin_modules::tests::`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::rules::`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::power_bootstrap::`
- 遗留事项：执行 BMS-42，继续下线 `BuiltinModuleSandbox` 的 builtin 注册兜底能力并清理相关引用。

- 日期：2026-02-13
- 完成内容：完成 BMS-42（下线 `BuiltinModuleSandbox` builtin 注册兜底能力）：
  - `crates/agent_world/src/runtime/builtin_modules.rs`：
    - 删除 `BuiltinModule` trait 与 `register_builtin` 机制。
    - `BuiltinModuleSandbox` 收敛为 wasm fallback 透传层（仅保留 `with_preferred_fallback` + `call`）。
    - 更新单测为“fallback 成功/失败透传”两条用例。
  - `crates/agent_world/src/runtime/mod.rs`：
    - 移除 `BuiltinModule` 的 re-export，保留 `BuiltinModuleSandbox` 与模块常量导出。
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::builtin_modules::tests::`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::rules::`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::power_bootstrap::`
- 遗留事项：执行 BMS-43，完成阶段三首轮回归收口与文档闭环。

- 日期：2026-02-13
- 完成内容：完成 BMS-43（cutover 阶段三首轮回归收口）：
  - 执行阶段三首轮回归并确认 wasm 路径稳定：
    - `agent_world_builtin_wasm` 全量单测通过。
    - `agent_world` 下 `runtime::tests::rules::`（wasmtime）通过。
    - `agent_world` 下 `runtime::tests::power_bootstrap::`（wasmtime）通过。
  - 更新项目管理文档并标记 BMS-43 完成：
    - `doc/world-runtime/builtin-wasm-crate-split.project.md`
    - `doc/world-runtime.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_builtin_wasm`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::rules::`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::power_bootstrap::`
- 遗留事项：评估是否启动下一轮下线（移除 `BuiltinModuleSandbox` 兼容层及相关导出）。

- 日期：2026-02-13
- 完成内容：推进 distributed crate split 二十六次扩展阶段，继续消除 runtime 与 `agent_world_consensus` 的重复实现：
  - `agent_world::runtime` 的 `distributed_membership_sync` 主体改为直接复用 `agent_world_consensus` 同源实现（`include!` + `shared` 包装）：
    - `crates/agent_world/src/runtime/distributed_membership_sync.rs`
  - 保留 runtime 本地 `reconciliation/recovery` 子模块与导出 API，不改变 `runtime` 对外命名面。
  - 为支持跨 crate 同源复用，补齐 `agent_world_consensus` 兼容 alias 和工具导出：
    - `crates/agent_world_consensus/src/lib.rs`（`distributed_consensus`、`distributed_net`、`distributed_dht::MembershipDirectorySnapshot`、`util::to_canonical_cbor`）
    - `crates/agent_world_consensus/src/membership.rs`（切换到 `super::*` alias 路径并导出 `to_canonical_cbor`）
  - 回写设计/项目管理文档：
    - `doc/world-runtime/distributed-crate-split-net-consensus.md`
    - `doc/world-runtime/distributed-crate-split-net-consensus.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_consensus`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world`
  - `env -u RUSTC_WRAPPER cargo test --workspace`
- 遗留事项：继续下一阶段，评估 `distributed_membership_sync` 的 `reconciliation/recovery` 子模块是否可进一步同源复用，减少 runtime 侧重复实现与 alias 成本。

- 日期：2026-02-13
- 完成内容：推进 distributed crate split 二十七次扩展阶段，继续消除 runtime 与 `agent_world_consensus` 的重复实现：
  - `agent_world::runtime` 的 `distributed_membership_sync/reconciliation.rs` 改为直接复用 `agent_world_consensus` 同源实现（`include!`）：
    - `crates/agent_world/src/runtime/distributed_membership_sync/reconciliation.rs`
  - 为支持双上下文同源复用，调整 `agent_world_consensus` reconciliation 导入路径至 `super::*` 兼容层：
    - `crates/agent_world_consensus/src/membership_reconciliation.rs`
  - 在 runtime membership sync 模块补齐 `membership` alias 层，供共享 reconciliation 文件解析路径：
    - `crates/agent_world/src/runtime/distributed_membership_sync.rs`
  - 回写设计/项目管理文档：
    - `doc/world-runtime/distributed-crate-split-net-consensus.md`
    - `doc/world-runtime/distributed-crate-split-net-consensus.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_consensus`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world`
  - `env -u RUSTC_WRAPPER cargo test --workspace`
- 遗留事项：继续下一阶段，推进 `distributed_membership_sync::recovery` 模块同源复用，进一步降低 runtime 与 consensus 的重复实现。

- 日期：2026-02-13
- 完成内容：推进 distributed crate split 二十八次扩展阶段，继续消除 runtime 与 `agent_world_consensus` 的重复实现：
  - `agent_world::runtime` 的 `distributed_membership_sync/recovery.rs` 改为路径模块复用
    `agent_world_consensus/src/membership_recovery/mod.rs`（`#[path] mod + pub use`）：
    - `crates/agent_world/src/runtime/distributed_membership_sync/recovery.rs`
  - 为支持双上下文同源复用，调整 `agent_world_consensus` recovery 共享源码中的导入路径为相对 `super::*`：
    - `crates/agent_world_consensus/src/membership_recovery/mod.rs`
    - `crates/agent_world_consensus/src/membership_recovery/stores.rs`
    - `crates/agent_world_consensus/src/membership_recovery/types.rs`
    - `crates/agent_world_consensus/src/membership_recovery/replay_audit.rs`
    - `crates/agent_world_consensus/src/membership_recovery/replay_archive_tiered.rs`
    - `crates/agent_world_consensus/src/membership_recovery/replay_archive_federated.rs`
  - 回写设计/项目管理文档：
    - `doc/world-runtime/distributed-crate-split-net-consensus.md`
    - `doc/world-runtime/distributed-crate-split-net-consensus.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_consensus`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world`
  - `env -u RUSTC_WRAPPER cargo test --workspace`
  - 期间首次 workspace 测试因磁盘不足失败（`No space left on device`）；执行 `env -u RUSTC_WRAPPER cargo clean` 清理后重跑通过。
- 遗留事项：继续下一阶段，清理 `agent_world::runtime/distributed_membership_sync/recovery/*` 未编译旧实现文件，收敛到纯同源复用结构。

- 日期：2026-02-13
- 完成内容：推进 distributed crate split 二十九次扩展阶段，完成 runtime recovery 旧实现文件物理清理：
  - 删除 `agent_world::runtime/distributed_membership_sync/recovery/*` 下 6 个未编译旧文件：
    - `dead_letter.rs`
    - `replay.rs`
    - `replay_audit.rs`
    - `replay_archive.rs`
    - `replay_archive_tiered.rs`
    - `replay_archive_federated.rs`
  - 运行时 recovery 入口保持为 `recovery.rs -> agent_world_consensus/src/membership_recovery/mod.rs` 同源复用，不变更导出 API。
  - 回写设计/项目管理文档：
    - `doc/world-runtime/distributed-crate-split-net-consensus.md`
    - `doc/world-runtime/distributed-crate-split-net-consensus.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo check -p agent_world`
  - `env -u RUSTC_WRAPPER cargo test --workspace`
- 遗留事项：继续下一阶段，收敛 `distributed_membership_sync.rs` 中超长 recovery re-export 列表，按能力分组并清理无效导入 warning。
- 完成内容：完成 BMS-44（阶段三第二轮任务拆解）：
  - `doc/world-runtime/builtin-wasm-crate-split.md`：
    - 新增阶段三第二轮路线（BMS-44~BMS-46）与里程碑 M18。
    - 补充“删除 `BuiltinModuleSandbox` 导出后编译失败”风险与对策。
  - `doc/world-runtime/builtin-wasm-crate-split.project.md`：
    - 新增 BMS-44~BMS-46 并切换到第二轮进行中状态。
  - `doc/world-runtime.project.md`：
    - 同步新增 BMS-44~BMS-46 与全局状态更新。
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::builtin_modules::tests::`
- 遗留事项：执行 BMS-45，移除 `BuiltinModuleSandbox` 类型与 `runtime` 对外导出。

- 日期：2026-02-13
- 完成内容：完成 BMS-45（删除 `BuiltinModuleSandbox` 兼容层类型与导出）：
  - `crates/agent_world/src/runtime/builtin_modules.rs`：
    - 删除 `BuiltinModuleSandbox` 类型及其 `with_preferred_fallback` 入口。
    - 删除对应单元测试，仅保留模块常量定义。
  - `crates/agent_world/src/runtime/mod.rs`：
    - 移除 `BuiltinModuleSandbox` 的 re-export，并将分组说明收敛为“Built-in module constants”。
  - 全量扫描确认无代码残留引用：
    - `rg "BuiltinModuleSandbox|with_preferred_fallback\\(" crates/agent_world/src`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::tests::basic::register_and_move_agent`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::rules::`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::power_bootstrap::`
- 遗留事项：执行 BMS-46，完成阶段三第二轮回归收口与文档闭环。

- 日期：2026-02-13
- 完成内容：完成 BMS-46（cutover 阶段三第二轮回归收口）：
  - 执行阶段三第二轮回归并确认 wasm 路径稳定：
    - `env -u RUSTC_WRAPPER cargo test -p agent_world_builtin_wasm`
    - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::rules::`
    - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::power_bootstrap::`
  - 更新项目管理文档并标记 BMS-46 完成：
    - `doc/world-runtime/builtin-wasm-crate-split.project.md`
    - `doc/world-runtime.project.md`
- 遗留事项：进入下一轮“逐步删除老 builtin 残留代码”任务拆解（待补充 BMS 新任务编号与里程碑）。

- 日期：2026-02-13
- 完成内容：完成 BMS-47（阶段三第三轮任务拆解）：
  - `doc/world-runtime/builtin-wasm-crate-split.md`：
    - 新增阶段三第三轮路线（BMS-47~BMS-49）与里程碑 M19。
    - 同步更新 runtime 装载接口现状描述（`BuiltinModuleSandbox` 已删除，仅剩常量层待清理）。
  - `doc/world-runtime/builtin-wasm-crate-split.project.md`：
    - 新增 BMS-47~BMS-49 并切换到第三轮进行中状态。
  - `doc/world-runtime.project.md`：
    - 同步新增 BMS-47~BMS-49 与全局状态更新。
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::tests::basic::register_and_move_agent`
- 遗留事项：执行 BMS-48，删除 `runtime/builtin_modules.rs` 并统一常量来源到 `agent_world_builtin_wasm`。

- 日期：2026-02-13
- 完成内容：完成 BMS-48（删除 runtime builtin 常量兼容层）：
  - `crates/agent_world/src/runtime/builtin_modules.rs`：
    - 删除文件，移除 runtime 本地 builtin 常量层。
  - `crates/agent_world/src/runtime/mod.rs`：
    - 移除 `mod builtin_modules`，改为直接 `pub use agent_world_builtin_wasm::{...}`。
  - `crates/agent_world_builtin_wasm/src/lib.rs`：
    - 补齐并公开 runtime 需要的常量导出（模块版本与参数常量）。
  - `crates/agent_world/Cargo.toml`：
    - 新增 `agent_world_builtin_wasm` 依赖，用于统一常量来源。
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_builtin_wasm`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::tests::basic::register_and_move_agent`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::rules::`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::power_bootstrap::`
- 遗留事项：执行 BMS-49，完成阶段三第三轮回归收口与文档闭环。

- 日期：2026-02-13
- 完成内容：完成 BMS-49（阶段三第三轮回归收口）：
  - 执行阶段三第三轮回归并确认“runtime 常量兼容层删除后”wasm 路径稳定：
    - `env -u RUSTC_WRAPPER cargo test -p agent_world_builtin_wasm`
    - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::rules::`
    - `env -u RUSTC_WRAPPER cargo test -p agent_world --features wasmtime runtime::tests::power_bootstrap::`
  - 更新项目管理文档并标记 BMS-49 完成：
    - `doc/world-runtime/builtin-wasm-crate-split.project.md`
    - `doc/world-runtime.project.md`
- 遗留事项：评估是否启动下一轮“逐步删除老 builtin 残留代码”任务拆解（待补充新任务编号）。

- 日期：2026-02-13
- 完成内容：完成 BMS-50（阶段四任务拆解与收尾路线文档化）：
  - `doc/world-runtime/builtin-wasm-crate-split.md`：
    - 修正 runtime 现状描述，移除“仍保留 `runtime/builtin_modules.rs`”的陈旧表述。
    - 新增阶段四收尾路线（BMS-50~BMS-55）与里程碑 M20。
    - 补充阶段四风险：单工件硬编码漂移风险、多工件迁移复杂度风险。
  - `doc/world-runtime/builtin-wasm-crate-split.project.md`：
    - 新增 BMS-50~BMS-55 任务并标记 BMS-50 完成。
    - 将状态切换为“阶段四已启动”，下一步明确为执行 BMS-51。
  - `doc/world-runtime.project.md`：
    - 同步新增 BMS-50~BMS-55 任务并更新全局状态。
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::tests::basic::register_and_move_agent`
- 遗留事项：执行 BMS-51，清理 `agent-default-modules`、`bootstrap-power-modules` 等文档中的陈旧描述并统一到 wasm-only 现状。

- 日期：2026-02-13
- 完成内容：推进 distributed crate split 三十次扩展阶段，收敛 `distributed_membership_sync` recovery 导出维护成本并处理无效导入 warning：
  - `crates/agent_world/src/runtime/distributed_membership_sync.rs`：
    - 移除超长内联 recovery re-export 列表，改为 `pub use recovery_exports::*;`，保留对外 API 命名不变。
  - 新增 `crates/agent_world/src/runtime/distributed_membership_sync/recovery_exports.rs`：
    - 按 recovery 能力集中管理导出。
    - 将仅测试使用的 composite sequence cursor 类型改为 `#[cfg(test)]` 条件导出。
  - `crates/agent_world/src/runtime/distributed_membership_sync/recovery.rs`：
    - 为共享 recovery 包装模块增加 `#[allow(unused_imports)]`，避免双上下文 include 下公共导出触发噪音 warning。
  - 回写设计/项目管理文档：
    - `doc/world-runtime/distributed-crate-split-net-consensus.md`
    - `doc/world-runtime/distributed-crate-split-net-consensus.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo check -p agent_world`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world recovery_replay_federated_tests`
- 遗留事项：继续下一阶段，评估 `distributed_membership_sync` 同源共享模块内 `dead_code` warning 的分层治理策略（避免在 runtime 复用上下文持续产生噪音）。

- 日期：2026-02-13
- 完成内容：推进 distributed crate split 三十一次扩展阶段，完成 `distributed_membership_sync` 同源复用 dead_code warning 分层治理：
  - `crates/agent_world/src/runtime/distributed_membership_sync.rs`：
    - 移除 `mod logic;`，消除 `logic.rs` 重复模块编译路径，避免同文件在 runtime 下重复触发 dead_code 噪音。
  - `crates/agent_world/src/runtime/distributed_membership_sync/recovery.rs`：
    - `membership_logic` alias 切换为复用 `super::super::membership_logic::*`，统一逻辑来源。
    - `shared_recovery` 包装模块增加 `#[allow(dead_code, unused_imports)]`，限定在 runtime 复用上下文抑制共享 recovery 导出噪音 warning。
  - 回写设计/项目管理文档：
    - `doc/world-runtime/distributed-crate-split-net-consensus.md`
    - `doc/world-runtime/distributed-crate-split-net-consensus.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo check -p agent_world`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::distributed_membership_sync::tests::membership_keyring_sign_and_verify_round_trip`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world recovery_replay_federated_tests`
- 遗留事项：继续下一阶段，评估 `distributed_observer_replay` 同源复用路径中的孤立 dead_code warning（`replay_validate_head_with_dht`）是否应做同类分层治理。

- 日期：2026-02-13
- 完成内容：推进 distributed crate split 三十二次扩展阶段，治理 `distributed_observer_replay` 同源复用孤立 dead_code warning：
  - `crates/agent_world/src/runtime/distributed_observer_replay.rs`：
    - 在 runtime 包装层增加 `#![allow(dead_code)]`，抑制共享 `observer_replay` helper（`replay_validate_head_with_dht`）在 runtime 上下文未导出导致的孤立 warning。
    - 保持共享实现文件与 runtime 对外导出 API 不变。
  - 回写设计/项目管理文档：
    - `doc/world-runtime/distributed-crate-split-net-consensus.md`
    - `doc/world-runtime/distributed-crate-split-net-consensus.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo check -p agent_world`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --test distributed_consistency`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --test distributed_multi_node`
- 遗留事项：继续下一阶段，评估 runtime 与 `agent_world_net` 其余 include! 复用模块是否还有上下文特异 warning，按“局部门控 + 定向测试”逐项收敛。

- 日期：2026-02-13
- 完成内容：推进 distributed crate split 三十三次扩展阶段，完成 runtime 与 `agent_world_net` 剩余 include 模块 warning 基线评估：
  - 扫描 runtime include 复用入口，确认评估范围覆盖 `distributed_net/dht/client/index/gateway/head_follow/observer/observer_replay/storage/validation` 等模块：
    - `rg -n "include!\\(" crates/agent_world/src/runtime | sort`
  - 执行编译基线检查并确认无新增 warning（`rg warning` 无匹配）：
    - `env -u RUSTC_WRAPPER cargo check -p agent_world --all-targets`
    - `env -u RUSTC_WRAPPER cargo check -p agent_world --all-targets --features wasmtime`
  - 回写设计/项目管理文档：
    - `doc/world-runtime/distributed-crate-split-net-consensus.md`
    - `doc/world-runtime/distributed-crate-split-net-consensus.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --test distributed_consistency`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --test distributed_multi_node`
- 遗留事项：继续下一阶段，把 include 复用 warning 基线检查固化为可复用脚本或 CI 子任务，降低后续阶段手工排查成本。

- 日期：2026-02-13
- 完成内容：推进 distributed crate split 三十四次扩展阶段，固化 include warning 基线门禁到脚本与 CI 统一入口：
  - 新增脚本 `scripts/check-include-warning-baseline.sh`：
    - 扫描 `crates/agent_world/src/runtime` 下 `include!` 复用入口并写入 `.tmp/include-warning-baseline/runtime-include-modules.txt`。
    - 执行双维度编译检查：
      - `env -u RUSTC_WRAPPER cargo check -p agent_world --all-targets`
      - `env -u RUSTC_WRAPPER cargo check -p agent_world --all-targets --features wasmtime`
    - 汇总并判定 warning 命中（`warning:`），命中时输出日志并返回失败。
  - `scripts/ci-tests.sh` 接入 `./scripts/check-include-warning-baseline.sh`，使 pre-commit 与 CI 复用同一 warning 基线门禁。
  - 回写设计/项目管理文档：
    - `doc/world-runtime/distributed-crate-split-net-consensus.md`
    - `doc/world-runtime/distributed-crate-split-net-consensus.project.md`
- 完成内容：执行并通过验证：
  - `./scripts/check-include-warning-baseline.sh`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --test distributed_consistency`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --test distributed_multi_node`
- 遗留事项：继续下一阶段，观察 CI 上 include warning 基线门禁稳定性，并将 warning 回归定位流程逐步模板化。

- 日期：2026-02-13
- 完成内容：推进 distributed crate split 三十五次扩展阶段（T73），启动 `agent_world_net` 基础化与 runtime 直接依赖切换：
  - `agent_world_net` 去除 `agent_world` 依赖并引入最小自有数据面：
    - `crates/agent_world_net/Cargo.toml`：移除 `agent_world`，新增 `runtime_bridge` feature（默认关闭）。
    - `crates/agent_world_net/src/lib.rs`：建立本地 `WorldError`、`modules`、`distributed_storage` 最小导出，runtime 强耦合模块改为 `runtime_bridge` 门控。
    - `crates/agent_world_net/src/{network,dht,gateway,util,libp2p_net}.rs`：统一改用 `crate::error::WorldError`。
    - `crates/agent_world_net/src/tests.rs`：改为不依赖 `agent_world` 的纯 net 回归（含 libp2p smoke）。
  - `agent_world` 新增对 `agent_world_net` 的显式依赖并完成首批模块切换：
    - `crates/agent_world/Cargo.toml`：新增 `agent_world_net` 依赖。
    - `crates/agent_world/src/runtime/distributed_{net,dht,client,gateway,index_store,provider_cache,dht_cache}.rs`：切到直接 re-export `agent_world_net`。
    - `crates/agent_world/src/runtime/distributed_index.rs`：保留 runtime 本地实现，避免 `ExecutionWriteResult` 双定义下签名冲突。
  - 错误桥接与共享实现兼容收敛：
    - `crates/agent_world/src/runtime/error.rs`：新增 `From<agent_world_net::WorldError>` 转换，打通 `?` 链路。
    - `crates/agent_world_consensus/src/membership.rs`：`publish_*` 返回路径改为 `? + Ok(())`，兼容 net/runtime 双错误类型上下文。
    - `crates/agent_world_consensus/src/lib.rs` + `crates/agent_world_consensus/Cargo.toml`：
      - `distributed_dht` trait 约束切换到 `agent_world_net::WorldError`，与 `InMemoryDht` 新实现对齐。
  - 回写设计/项目管理文档：
    - `doc/world-runtime/distributed-crate-split-net-consensus.md`
    - `doc/world-runtime/distributed-crate-split-net-consensus.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_net`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_net --features libp2p --lib`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --test distributed_consistency`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --test distributed_multi_node`
- 遗留事项：继续下一阶段执行 T74，将 `WorldError` 与执行产物索引数据面进一步下沉到 `agent_world_proto`，收敛 `distributed_storage/validation/index` 双类型与剩余 include 包装层。

- 日期：2026-02-13
- 完成内容：推进 distributed crate split 三十六次扩展阶段（T74），完成 `WorldError` 公共依赖下沉到 proto：
  - `crates/agent_world_proto/src/world_error.rs`：新增 `WorldError` 公共定义（network request/validation/io/serde）。
  - `crates/agent_world_proto/src/lib.rs` + `crates/agent_world_proto/Cargo.toml`：
    - 导出 `world_error` 模块。
    - 将 `serde_cbor` 提升为常规依赖，支撑 `From<serde_cbor::Error>`。
  - `crates/agent_world_net/src/lib.rs`：
    - `error::WorldError` 改为直接复用 `agent_world_proto::world_error::WorldError`，去除 net 本地重复定义。
  - 保持 runtime 到 net 错误桥接链路不变（`From<agent_world_net::WorldError>` 继续生效）。
  - 回写设计/项目管理文档：
    - `doc/world-runtime/distributed-crate-split-net-consensus.md`
    - `doc/world-runtime/distributed-crate-split-net-consensus.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_proto`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_net --features libp2p --lib`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world --all-targets`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world --all-targets --features wasmtime`
- 遗留事项：继续下一阶段执行 T75，把 `ExecutionWriteResult` 等执行产物索引数据面下沉到 `agent_world_proto`，再推进剩余 include 包装层替换。

- 日期：2026-02-13
- 完成内容：推进 distributed crate split 三十七次扩展阶段（T75），完成执行产物索引公共数据面下沉与 runtime/net 双类型收敛：
  - `crates/agent_world_proto/src/distributed_storage.rs`：
    - 新增公共数据面类型：`SegmentConfig`、`JournalSegmentRef`、`ExecutionWriteConfig`、`ExecutionWriteResult`。
  - `crates/agent_world_proto/src/lib.rs`：
    - 导出 `distributed_storage` 模块。
  - `crates/agent_world_net/src/lib.rs`：
    - `distributed_storage` 改为直接复用 proto 的 `ExecutionWriteConfig`/`ExecutionWriteResult`，删除 net 本地重复定义。
  - `crates/agent_world/src/runtime/distributed_storage.rs`：
    - 切换为复用 net/proto 统一类型，`store_execution_result` 行为保持不变。
  - `crates/agent_world/src/runtime/segmenter.rs`：
    - 切换为复用 proto 的 `SegmentConfig`/`JournalSegmentRef`，避免 runtime 与 net 并行定义漂移。
  - `crates/agent_world/src/runtime/distributed_index.rs`：
    - 改为调用 `agent_world_net` 索引实现并桥接到 runtime `WorldError`，移除 runtime 本地重复 hash 聚合逻辑。
  - `crates/agent_world_net/src/tests.rs`：
    - 调整测试构造数据以匹配 `journal_segments: Vec<JournalSegmentRef>` 新统一类型。
  - 回写设计/项目管理文档：
    - `doc/world-runtime/distributed-crate-split-net-consensus.md`
    - `doc/world-runtime/distributed-crate-split-net-consensus.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_proto`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world_net`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world --all-targets`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world --all-targets --features wasmtime`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world_net --lib`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --test distributed_consistency`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --test distributed_multi_node`
  - `./scripts/check-include-warning-baseline.sh`
- 遗留事项：继续下一阶段执行 T76，清理 `distributed_storage` / `distributed_validation` 剩余 include 包装层并推进 net 纯实现直连。

- 日期：2026-02-13
- 完成内容：推进 distributed crate split 三十八次扩展阶段（T76），清理 storage/validation include 包装层：
  - `crates/agent_world/src/runtime/distributed_storage.rs`：
    - 移除 `include!("../../../agent_world_net/src/execution_storage.rs")`，改为 runtime 本地直接实现 `store_execution_result` 与 hash helper。
    - 保持 `ExecutionWriteConfig` / `ExecutionWriteResult` 继续复用 net/proto 统一类型，避免数据面回退到双定义。
  - `crates/agent_world/src/runtime/distributed_validation.rs`：
    - 移除 `include!("../../../agent_world_net/src/head_validation.rs")`，改为 runtime 本地直接实现 `validate_head_update` / `assemble_snapshot` / `assemble_journal`。
    - 保持 `HeadValidationResult`、校验流程语义与错误返回不变。
  - include 入口扫描确认 `runtime` 侧 include 列表已去掉 storage/validation 两项。
  - 回写设计/项目管理文档：
    - `doc/world-runtime/distributed-crate-split-net-consensus.md`
    - `doc/world-runtime/distributed-crate-split-net-consensus.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo check -p agent_world --all-targets`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world --all-targets --features wasmtime`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::distributed_storage::tests::store_execution_result_writes_block_and_refs`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::distributed_validation::tests::validate_head_update_accepts_written_block`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --test distributed_consistency`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --test distributed_multi_node`
  - `./scripts/check-include-warning-baseline.sh`
- 遗留事项：继续下一阶段执行 T77，推进 `distributed_bootstrap` / `distributed_head_follow` / `distributed_observer(_replay)` 的 include 替换策略并优先收敛低耦合入口。

- 日期：2026-02-13
- 完成内容：推进 distributed crate split 三十九次扩展阶段（T77），完成 bootstrap include 包装层收敛：
  - `crates/agent_world/src/runtime/distributed_bootstrap.rs`：
    - 移除 `include!("../../../agent_world_net/src/bootstrap.rs")`，改为 runtime 本地直接实现：
      - `bootstrap_world_from_head`
      - `bootstrap_world_from_head_with_dht`
      - `bootstrap_world_from_dht`
    - 保持函数签名与行为语义不变，继续复用现有 `observer_replay` / `client` / `dht` 链路。
  - include 入口扫描确认 `runtime` 侧 include 列表已去掉 `distributed_bootstrap.rs`。
  - 回写设计/项目管理文档：
    - `doc/world-runtime/distributed-crate-split-net-consensus.md`
    - `doc/world-runtime/distributed-crate-split-net-consensus.project.md`
- 完成内容：执行并通过验证：
  - `env -u RUSTC_WRAPPER cargo check -p agent_world --all-targets`
  - `env -u RUSTC_WRAPPER cargo check -p agent_world --all-targets --features wasmtime`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::distributed_bootstrap::tests::bootstrap_world_from_head_round_trip`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world runtime::distributed_bootstrap::tests::bootstrap_world_from_dht_round_trip`
  - `env -u RUSTC_WRAPPER cargo test -p agent_world --test distributed_bootstrap`
  - `./scripts/check-include-warning-baseline.sh`
- 遗留事项：继续下一阶段执行 T78，推进 `distributed_head_follow` / `distributed_observer(_replay)` include 替换策略并优先收敛低耦合入口。
