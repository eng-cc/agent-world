# Viewer 发行体验改造（第十阶段：新手流程闭环与认知减负）

## 目标
- 修复新手流程中的“进度跳步”问题，确保教程按真实行为推进，不再出现 2/4 直接到 4/4。
- 把第 4 步操作提示从抽象描述改成可执行动作提示，让玩家明确“下一步点哪里”。
- 继续压缩隐藏态信息密度，减少首屏多卡片并行发声导致的认知负担。

## 范围
- `crates/agent_world_viewer` Player 模式 UI/引导逻辑调整：
  - 调整 `PlayerGuideProgressSnapshot` 的完成判定，新增“执行反馈”门槛后再允许 4/4 完成。
  - 调整 `ExploreAction` 阶段的任务动作文案，改为具体可执行的控制建议。
  - 调整隐藏态入口信息层级，避免与新手引导卡/任务 HUD 同时形成过多主卡片。
  - 补充纯函数与引导流程相关单测。
- 不改动 Director 模式调试语义。

## 非目标
- 不改动仿真协议、事件语义与后端链路。
- 不改动 `third_party`。
- 不引入新的大型美术资源或复杂动效系统。

## 接口/数据

### 复用状态
- `ViewerState.events`：用于判定是否出现“执行反馈”。
- `RightPanelLayoutState`：用于隐藏态/展开态的引导层级策略。
- `PlayerGuideStep` / `PlayerGuideProgressSnapshot`：维持教程步骤与任务 HUD 一致性。

### 新增/调整行为
- 教程完成门槛：
  - `ExploreAction` 不再由“已选中目标”直接达成。
  - 需要出现可视反馈（事件）后才计入第 4 步完成。
- 文案策略：
  - 第 4 步动作提示改为“使用右侧控制按钮（暂停/继续）或发送指挥消息”等具体操作。
- 隐藏态减噪：
  - 调整隐藏态入口卡展示策略，保留必要入口但降低并行主卡数量。

## 里程碑
- M1：第十阶段建档完成（设计 + 项管）。
- M2：教程进度门槛与第 4 步动作文案改造完成并有单测覆盖。
- M3：隐藏态减噪策略完成并有定向验证。
- M4：回归测试、Playwright 新手流程复测与文档收口完成。

## 风险
- 风险 1：第 4 步门槛提高后，部分场景下完成速度下降。
  - 对策：采用“任一有效世界事件即可”策略，避免过严卡死。
- 风险 2：隐藏态入口卡减弱后可发现性下降。
  - 对策：保留边缘呼出入口与任务 HUD 指挥按钮双入口。
- 风险 3：文案更具体后中英文一致性回归。
  - 对策：同步更新中英文文案并覆盖关键断言测试。
