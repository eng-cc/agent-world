# Agent World Simulator：Viewer 控制区精简与高级调试折叠（设计文档）

## 目标
- 面向 chat 驱动 Agent 的日常操作，简化控制区：默认仅保留一个“播放/暂停”切换按钮。
- 将 `单步` 与 `跳转(0)` 折叠进“高级调试”区域，降低误触和认知负担。
- 保持现有实时控制协议不变（仍使用 `ViewerControl::{Play,Pause,Step,Seek}`）。

## 范围

### 范围内
- 调整 `agent_world_viewer` EGUI 控制区按钮布局：
  - `播放/暂停` 合并为单按钮（根据当前 UI 运行态切换发送 Play 或 Pause）。
  - 新增“高级调试”开关；展开后显示 `单步` 与 `跳转 0`。
- 新增控制区本地 UI 状态（是否播放、是否展开高级调试）。
- 补充/更新单元测试，覆盖：
  - 播放/暂停单按钮文案切换。
  - 控制发送后本地运行态更新。
  - 高级调试折叠状态切换。
- 更新 Viewer 手册中“常用交互”相关说明。

### 范围外
- 不改 `viewer` 协议定义与 live server 控制语义。
- 不改 timeline 模块内部细节（时间轴 `seek/jump` 逻辑保持现状）。
- 不改 Chat 模块交互与 Prompt Ops 流程。

## 接口 / 数据
- 协议层：无新增字段。
- Viewer 端新增 EGUI 本地状态结构（仅 UI 运行态，不持久化）：
  - `playing: bool`：当前按钮语义是否处于“已播放”。
  - `advanced_debug_expanded: bool`：高级调试是否展开。
- 文案层新增本地化函数：
  - 播放/暂停单按钮标签。
  - 高级调试折叠开关标签。

## 里程碑
- M1：设计文档与项目管理文档完成。
- M2：控制区重构（单按钮 + 折叠区）完成。
- M3：测试回归 + 手册更新 + 文档状态收口完成。

## 风险
- 风险：本地 `playing` 状态与服务端真实状态可能短暂不一致（例如外部客户端同时控制）。
  - 缓解：保持按钮“最后一次本地控制语义”一致；不改协议，后续如需绝对一致可引入 server playback status 回传。
- 风险：高级调试折叠后，调试入口层级加深。
  - 缓解：折叠按钮固定在控制区首行，默认文案明确可发现。
