# Viewer 发行体验改造（第四阶段：场景活化与交互动效）

## 目标
- 在第三阶段“成就/气泡反馈”基础上，继续提升玩家沉浸感与舒适度：
  - 增强主场景氛围层，降低“纯工具画面”感。
  - 为关键引导卡与目标提示加入轻量过渡动效，减少 UI 生硬感。
  - 保持 Player 低噪声原则，避免技术信息回流为主视觉。

## 范围
- `crates/agent_world_viewer` UI 侧改造：
  - Player 氛围背景层（呼吸光晕/层次暗角/边缘发光）。
  - Player 引导/目标卡片过渡动效（淡入、轻微位移、呼吸脉冲）。
  - Player 体验层现有元素（HUD/引导/成就/气泡）风格联动。
- 中英文文案保持一致并可切换。

## 非目标
- 不修改仿真核心协议与 `agent_world` 核心逻辑。
- 不改 `third_party` 目录。
- 不引入模型/贴图等大型美术资产包。

## 接口/数据

### 本地 UI 状态
- 复用现有 Player 本地状态，新增轻量动画计算参数：
  - 氛围层动态参数（alpha/偏移/脉冲相位）。
  - 引导卡片动效参数（入场位移/透明度）。
- 保持 `ViewerExperienceMode` 分流：
  - `player`：启用氛围层与过渡动效。
  - `director`：保持调试导向，不强制启用该风格层。

### 触发策略
- 氛围层触发：Player 模式持续渲染，按时间相位平滑变化。
- 动效触发：引导目标步骤与卡片显示状态变化时激活入场动画。
- 防噪音约束：
  - 动画幅度小、频率低、透明度受限。
  - 不遮挡核心交互区域，不影响点击与键盘操作。

## 里程碑
- M1：第四阶段建档完成（设计 + 项管）。
- M2：Player 场景氛围层落地并具备单测覆盖。
- M3：Player 引导/目标动效落地并具备单测覆盖。
- M4：回归测试 + Web 闭环验收 + 文档收口。

## 风险
- 氛围层过强导致可读性下降。
  - 对策：限制透明度上限，优先保障文字和操作区对比度。
- 动效频率过高造成视觉疲劳。
  - 对策：采用低频、短位移动画，并支持衰减与静态回落。
- 不同硬件下 Web 渲染差异导致观感不一致。
  - 对策：使用保守参数并在 Playwright Web 闭环中验证可见性与稳定性。
