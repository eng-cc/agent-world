# Viewer 可视化观察体验优化设计

## 目标
- 将右侧面板从“复制导向”调整为“观察导向”，减少外部复制分析依赖。
- 提升状态可见性：尽量在一个视图里直接看到关键运行情况，而不是反复折叠展开。
- 保持现有交互能力（控制、联动、时间轴、覆盖层）不退化。
- 保持中英文可读性和 EGUI 中文字体稳定显示。

## 范围
- **范围内**
  - 右侧 EGUI 面板视觉结构优化：增加总览、降低折叠层级、统一分组样式。
  - 复制相关文案改为“观察/明细”导向，不新增一键复制能力。
  - 调试脚本 `capture-viewer-frame.sh` 增加场景参数预校验（避免无效场景导致闭环失败）。
- **范围外**
  - 不改动 3D 渲染算法和协议层数据模型。
  - 不新增外部导出/报告能力。

## 接口 / 数据

### 1) 面板布局策略
- 在 `egui_right_panel.rs` 中新增“总览指标”渲染（tick、事件数、轨迹数、选择态等）。
- 将状态块改为默认可见分组，减少 `collapsing` 依赖。
- 保留已有资源读取：`ViewerState`、`ViewerSelection`、`TimelineUiState`、`DiagnosisState`、`EventObjectLinkState`。

### 2) 文案策略
- `copyable_panel_toggle_label`、`copy_panel_title`、`copy_panel_hint` 改为观察导向描述：
  - 不强调“复制”动作。
  - 强调“在面板内直接观察与比对”。

### 3) 脚本预校验
- `scripts/capture-viewer-frame.sh` 增加场景白名单与别名规范化。
- 对非法场景在启动 server 前直接报错，并提示可用列表与常用别名。

## 里程碑
- **V1**：完成设计文档与项目拆解。
- **V2**：完成场景预校验脚本增强（P1）。
- **V3**：完成右侧面板可视化优化与文案调整（P3，去复制导向）。
- **V4**：完成回归测试、截图闭环验证与日志收口。

## 风险
- **信息过载**：全部展开导致阅读压力上升。
  - 缓解：增加“总览 + 分组”结构，保持层级但不深度折叠。
- **文案回归**：修改中英文文案后测试断言失效。
  - 缓解：同步更新现有 i18n 与 copyable 文案测试。
- **脚本维护成本**：白名单与实际场景漂移。
  - 缓解：在错误提示中输出当前脚本支持清单，并保留别名映射可维护入口。
